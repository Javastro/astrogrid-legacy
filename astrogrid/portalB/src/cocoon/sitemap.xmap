
<!--+
    |
    | Sub sitemap for Astrogrid services.
    |
    ! Version 1.1
    !
    ! Authors: Brian McIlwrath (bkm@star.rl.ac.uk)
    !          Dave Morris     (dave@cam.as.ac.uk)
    ! Date: 14th August 2003
    +-->

<map:sitemap xmlns:map="http://apache.org/cocoon/sitemap/1.0">

<!-- ======================== Components ================================ -->

   <map:components>
      <map:generators default="file"/>
      <map:transformers default="xslt"/>
      <map:readers default="resource">
         <map:reader name="votable"
              pool-max="32"
              src="org.astrogrid.portal.cocoon.plugins.readers.VotableReader"/>
      </map:readers>
      <map:serializers default="html"/>
      <map:selectors default="browser"/>
      <map:matchers default="wildcard"/>
      <map:actions>
   	     <map:action name="astrogrid" src="org.astrogrid.portal.cocoon.common.AstrogridAction"/>
         <map:action name="astrogrid-explorer"
         	src="org.astrogrid.portal.cocoon.explorer.ExplorerAction"/>
         <map:action name="astrogrid-query" 
	     	src="org.astrogrid.portal.cocoon.query.QueryAction"/>
         <map:action name="astrogrid-admin" 
         	src="org.astrogrid.portal.cocoon.community.AdministrationAction"/>            
	    <map:action name="astrogrid-credentials" src="org.astrogrid.portal.cocoon.community.CredentialAction"/>
	    <map:action name="astrogrid-login" src="org.astrogrid.portal.cocoon.common.LoginAction"/>
	    <map:action name="astrogrid-workflow" src="org.astrogrid.portal.cocoon.workflow.design.DesignAction"/>

         <!-- AstroGrid QB actions. -->
         <map:action name="xml-validator" logger="sitemap.action.xml-validator" src="org.astrogrid.datacenter.cocoon.acting.XMLValidatorAction"/>

         <map:action name="save-adql" logger="sitemap.action.save-adql" src="org.astrogrid.datacenter.cocoon.acting.SaveAction"/>

         <map:action name="load-adql" logger="sitemap.action.load-adql" src="org.astrogrid.datacenter.cocoon.acting.LoadAction"/>

         <map:action name="test-adql" logger="sitemap.action.test-adql" src="org.astrogrid.datacenter.cocoon.acting.TestAction"/>
 
      </map:actions>
   </map:components>

<!-- =========================== Views =================================== -->

   <!-- Views for MySpace Explorer -->
   <map:views>
      <!-- Original XML displayed as XML -->
      <map:view name="000" from-label="000">
         <map:serialize type="xml"/>
      </map:view>
      <!-- Original XML, displayed as XML/HTML -->
      <map:view name="001" from-label="001">
         <!-- Convert into XML/HTML -->
         <map:transform src="common/xsl/xml-html.xsl"/>
         <map:serialize type="html"/>
      </map:view>
      <!-- XML processed into a page, displayed as XML/HTML -->
      <map:view name="002" from-label="002">
         <!-- Convert into XML/HTML -->
         <map:transform src="common/xsl/xml-html.xsl"/>
         <map:serialize type="html"/>
      </map:view>
      <!-- Page wrapped in our template, displayed as XML/HTML -->
      <map:view name="003" from-label="003">
         <!-- Convert into XML/HTML -->
         <map:transform src="common/xsl/xml-html.xsl"/>
         <map:serialize type="html"/>
      </map:view>
   </map:views>

<!-- ========================== Action sets ================================ -->
<!-- QB -->
  <map:action-sets>
    <map:action-set name="adql_form_xml">
      <map:act type="form-validator">
        <map:parameter
            name="descriptor"
            value="qb/content/defs/adql-def.xml"/>

        <!-- Validate ADQL query -->
        <map:act type="xml-validator">
        </map:act>
      </map:act>

      <!-- Validate ADQL query -->
      <map:act type="xml-validator">
        <map:act type="form-validator">
          <map:parameter
              name="descriptor"
              value="qb/content/defs/adql-def.xml"/>
        </map:act>
      </map:act>
    </map:action-set>
  </map:action-sets>

<!-- ========================== Action sets ================================ -->

<!-- ========================== Resources ================================= -->

   <map:resources>
    <!-- QB -->
    <map:resource name="adql-form">
      <!-- Generate the ADQL form -->
      <map:generate type="serverpages" src="qb/content/dynamic/adql-form.xsp" label="000, 001"/>
      <map:transform type="xslt" src="qb/style/adql.xsl" label="002"/>

      <!-- Wrap the page in the Portal template -->
      <map:act type="astrogrid">
         <map:transform src="common/xsl/astrogrid.xsl" label="003">
            <!-- Add the rest of the page names -->
            <map:parameter name="credential" value="{credential}" />
            <map:parameter name="current-page"  value="agdataquery.html"/>
            <map:parameter name="query-page"    value="agdataquery.html"/>
            <map:parameter name="myspace-page"  value="agmyspace.html"/>
            <map:parameter name="title-name"  value="Data Query"/>
            <map:parameter name="home-page"     value="agindex.html"/>
            <map:parameter name="admin-page"    value="agadministration.html"/>
            <map:parameter name="help-page"     value="agdataqueryhelp.html"/>
            <map:parameter name="registry-page" value="agregistry.html"/>
            <map:parameter name="regadmin-page" value="agregadmin.html"/>
            <map:parameter name="monitor-page"  value="agjobmonitor.html"/>
            <map:parameter name="tools-page"    value="agtools.html"/>
            <map:parameter name="logout-page"   value="aglogout.html"/>
         </map:transform>
       </map:act>

       <!-- Serialize as HTML -->
       <map:serialize type="html"/> 
    </map:resource>
   </map:resources>

<!-- ========================== Pipelines ================================= -->

   <map:pipelines>
      <map:pipeline>
         <map:match pattern="">
            <map:redirect-to uri="aglogin.html"/>
         </map:match>

         <!-- Registry browser and admin pages -->
         <map:match pattern="registry">
            <map:redirect-to uri="agregistry.html"/>
         </map:match>

         <map:match pattern="registry/**">
            <map:mount uri-prefix="registry" src="registry/sitemap.xmap"  check-reload="yes" reload-method="synchron"/>
         </map:match>


         <map:match pattern="agregistry.html">
              <map:generate src="registry/xsp/browse.xsp" type="serverpages"/>
              <map:transform src="registry/xsl/browse.xsl"/>
 
            <map:transform src="common/xsl/astrogrid.xsl" label="003">
               <!-- Add the rest of the page names -->
               <map:parameter name="current-page"  value="agcredentials.html"/>
               <map:parameter name="query-page"    value="agdataquery.html"/>
               <map:parameter name="myspace-page"  value="agmyspace.html"/>
               <map:parameter name="home-page"     value="agindex.html"/>
               <map:parameter name="help-page"     value="agdataqueryhelp.html"/>
               <map:parameter name="title-name"    value="Credentials"/>               
               <map:parameter name="registry-page" value="agregistry.html"/>
               <map:parameter name="regadmin-page" value="agregadmin.html"/>
               <map:parameter name="monitor-page"  value="agjobmonitor.html"/>
               <map:parameter name="tools-page"    value="agtools.html"/>
               <map:parameter name="admin-page"    value="agadministration.html"/>
               <map:parameter name="logout-page"   value="aglogout.html"/>
            </map:transform>
              <map:serialize type="html"/>
         </map:match>

         <map:match pattern="agregadmin.html">
              <map:generate src="registry/xsp/admin.xsp" type="serverpages"/>
              <map:transform src="registry/xsl/admin.xsl"/>
              <map:serialize type="html"/>
         </map:match>

         <map:match pattern="aglogin.html">
         	<map:act type="astrogrid-login">
               <map:generate src="common/xsp/login.xsp" type="serverpages" label="000, 001"/>         	
              <map:transform src="common/xsl/login.xsl" label="002">
                  <map:parameter name="action" value="{action}"/>
                  <map:parameter name="errormessage" value="{errormessage}"/>
                  <map:parameter name="admin" value="{admin}"/>
                  <map:parameter name="adminEmail" value="{adminEmail}"/>
                  <map:parameter name="message" value="{message}"/>
                  <map:parameter name="secure_connection" value="{secure_connection}"/>
                  <map:parameter name="secure_url" value="{secure_url}"/>
              </map:transform>
             </map:act>
	          <map:transform src="common/xsl/astrogrid.xsl" label="003">
		        <map:parameter name="current-page"  value="agdataquery.html"/>
               <!-- Add the rest of the page names -->
               <map:parameter name="current-page"  value="aglogin.html"/>
               <map:parameter name="query-page"    value="agdataquery.html"/>
               <map:parameter name="myspace-page"  value="agmyspace.html"/>
               <map:parameter name="home-page"     value="agindex.html"/>
               <map:parameter name="help-page"     value="agdataqueryhelp.html"/>
               <map:parameter name="registry-page" value="agregistry.html"/>
               <map:parameter name="regadmin-page" value="agregadmin.html"/>
               <map:parameter name="monitor-page"  value="agjobmonitor.html"/>
               <map:parameter name="tools-page"    value="agtools.html"/>
               <map:parameter name="title-name"  value="Login"/>               
               <map:parameter name="admin-page"    value="agadministration.html"/>
               <map:parameter name="logout-page"   value="aglogout.html"/>
            </map:transform>
            <!-- Serialize as HTML -->
            <map:serialize type="html"/>
         </map:match>

         <map:match pattern="agnologin.html">
            <map:read mime-type="text/html" src="html/agnologin.html"/>
         </map:match>

         <!-- Site images -->
         <map:match pattern="*.gif">
            <map:read src="images/{1}.gif" mime-type="images/gif"/>
         </map:match>
         <map:match pattern="*.png">
            <map:read src="images/{1}.png" mime-type="images/png"/>
         </map:match>

         <!-- Administration page -->
         <map:match pattern="agadministration.html">
            <!-- Call our query action -->
            <map:act type="astrogrid-admin">
               <!-- Set the session attribute to check for the user name -->
               <map:parameter name="user-param"  value="user"/>
               <!-- Generate our page XML -->
               <map:generate src="community/xsp/administration.xsp" type="serverpages" label="000, 001"/>
               <!-- Convert the data into a page -->
               <map:transform src="community/xsl/administration.xsl" label="002">
                  <map:parameter name="action" value="{action}"/>
                  <map:parameter name="errormessage" value="{errormessage}"/>
                  <map:parameter name="message" value="{message}"/>
               </map:transform>
            </map:act>
            <!-- Wrap the page in our HTML template -->
            <map:act type="astrogrid">
            <map:transform src="common/xsl/astrogrid.xsl" label="003">
		              <map:parameter name="credential" value="{credential}" />
		              <map:parameter name="current-page"  value="agdataquery.html"/>
            
               <!-- Add the rest of the page names -->
               <map:parameter name="current-page"  value="agadministration.html"/>
               <map:parameter name="query-page"    value="agdataquery.html"/>
               <map:parameter name="myspace-page"  value="agmyspace.html"/>
               <map:parameter name="home-page"     value="agindex.html"/>
               <map:parameter name="help-page"     value="agdataqueryhelp.html"/>
               <map:parameter name="registry-page" value="agregistry.html"/>
               <map:parameter name="regadmin-page" value="agregadmin.html"/>
               <map:parameter name="monitor-page"  value="agjobmonitor.html"/>
               <map:parameter name="tools-page"    value="agtools.html"/>
               <map:parameter name="title-name"  value="Administration"/>               
               <map:parameter name="admin-page"    value="agadministration.html"/>
               <map:parameter name="logout-page"   value="aglogout.html"/>
            </map:transform>
            </map:act>
            <!-- Serialize as HTML -->
            <map:serialize type="html"/>
         </map:match>
            



         <!-- Block the rest of the sitemap to non-logged-in users -->
         <map:match type="sessionstate" pattern="*">
            <map:parameter name="attribute-name" value="user"/>
            
            <map:match pattern="index.html">
               <map:redirect-to uri="agindex.html"/>
            </map:match>

            <map:match pattern="aglogout.html">
               <map:generate type="serverpages" src="xsp/logout.xsp"/>
               <map:transform src="xsl/redirect.xsl"/> 
               <map:serialize type="html"/>
            </map:match>

            <map:match pattern="agtopcat.html">
               <map:generate type="serverpages" src="plugins/xsp/topcat.xsp"/>
               <map:transform src="plugins/xsl/topcat.xsl"/>
               <map:serialize type="html"/>
            </map:match>

	         <map:match pattern="votable">
    	       <map:read type="votable" mime-type="image/png" src="{1}.vot"/>
        	 </map:match>

            <map:match pattern="agtemplate.xsl">
               <map:redirect-to uri="xsl/agtemplate.xsl"/>
            </map:match>

            <!-- DataQuery page -->
            <!-- QB -->
            <map:match pattern="agdataquery.html">
        		<!-- Test ADQL action -->
		       <map:select type="request-parameter">
		          <map:parameter
		              name="parameter-name"
		              value="action"/>
		
		          <!-- ADQL action: TEST -->
		          <map:when test="Test">
		            <!-- Validate ADQL form. -->
		            <map:act set="adql_form_xml">
		              <map:parameter
		                  name="validate-set"
		                  value="test"/>
		
		              <map:parameter
		                  name="xml-param"
		                  value="query"/>
		
		              <!-- Validate ADQL form: success. -->
		              <map:act type="test-adql">
		<!--
		                <map:parameter
		                    name="datacenter-delegate-class"
		                    value="dummy.astrogrid.datacenter.delegate.DummyDelegate"/>
		OR/
		                <map:parameter
		                    name="datacenter-end-point"
		                    value="uri-param"/>
		-->
		
		                <map:parameter
		                    name="adql-query"
		                    value="query"/>
		
		                <map:parameter
		                    name="datacenter-end-point"
		                    value="URI"/>
		
		                <map:call resource="adql-results"/>
		              </map:act>
		            </map:act>
		
		            <!-- Validate ADQL form: errors. -->
		            <map:call resource="adql-form"/>
		          </map:when>
		          <!-- ADQL action: TEST -->
		
		          <!-- ADQL action: LOAD -->
		          <map:when test="Load">
		            <!-- Validate ADQL form. -->
		            <map:act type="form-validator">
		              <map:parameter
		                  name="descriptor"
		                  value="qb/content/defs/adql-def.xml"/>
		
		              <map:parameter
		                  name="validate-set"
		                  value="load"/>
		
		              <map:act type="load-adql">
		                <map:parameter
		                    name="myspace-end-point"
		                    value="http://143.210.36.173:8080/axis/services/MySpaceManager"/>
		
		                <map:parameter
		                    name="myspace-delegate-class"
		                    value="org.astrogrid.mySpace.delegate.mySpaceManager.MySpaceManagerDelegate"/>
		
		                <map:parameter
		                    name="username"
		                    value="username"/>
		
		                <map:parameter
		                    name="community-id"
		                    value="community"/>
		
		                <map:parameter
		                    name="credential"
		                    value="credential"/>
		
		                <map:parameter
		                    name="myspace-name"
		                    value="name"/>
		
		                <!-- Validate ADQL form: success. -->
		                <map:call resource="adql-form"/>
		              </map:act>
		            </map:act>
		
		            <!-- Validate ADQL form: errors. -->
		            <map:call resource="adql-form"/>
		          </map:when>
		          <!-- ADQL action: LOAD -->
		
		          <!-- ADQL action: SAVE -->
		          <map:when test="Save">
		            <!-- Validate ADQL form. -->
		            <map:act set="adql_form_xml">
		              <map:parameter
		                  name="validate-set"
		                  value="save"/>
		
		              <map:parameter
		                  name="xml-param"
		                  value="query"/>
		
		              <!-- SUCCESS: save ADQL. -->
		              <map:act type="save-adql">
		                <map:parameter
		                    name="myspace-end-point"
		                    value="http://143.210.36.173:8080/axis/services/MySpaceManager"/>
		
		                <map:parameter
		                    name="myspace-delegate-class"
		                    value="org.astrogrid.mySpace.delegate.mySpaceManager.MySpaceManagerDelegate"/>
		
		                <map:parameter
		                    name="username"
		                    value="username"/>
		
		                <map:parameter
		                    name="community-id"
		                    value="community"/>
		
		                <map:parameter
		                    name="credential"
		                    value="credential"/>
		
		                <map:parameter
		                    name="myspace-name"
		                    value="name"/>
		
		                <map:parameter
		                    name="adql-query"
		                    value="query"/>
		              </map:act>
		            </map:act>
		
		            <!-- Validate ADQL form: errors. -->
		            <map:call resource="adql-form"/>
		          </map:when>
		          <!-- ADQL action: SAVE -->
		
		          <!-- ADQL action: *invalid* -->
		          <map:otherwise>
		            <map:call resource="adql-form"/>
		          </map:otherwise>
		          <!-- ADQL action: *invalid* -->
		
		          <map:call resource="adql-form"/>
		        </map:select>
            </map:match>  

            <map:match pattern="old-agdataquery.html">
               <!-- Call our query action -->
               <map:act type="astrogrid-query">
                  <!-- Set the session attribute to check for the user name -->
                  <map:parameter name="user-param"  value="user"/>
                  <!-- Generate our page XML -->
                  <map:generate src="query/xsp/query.xsp" type="serverpages" label="000, 001"/>
                  <!-- Convert the data into a page -->
                  <map:transform src="query/xsl/query.xsl" label="002">
                     <!-- Add the action params -->
                     <map:parameter name="QueryString" value="{QueryString}"/>
                     <map:parameter name="Script" value="{Script}"/>
                     <map:parameter name="QueryStringSent" value="{QueryStringSent}"/>
                     <map:parameter name="ErrorMessage" value="{ErrorMessage}"/>
                     <map:parameter name="LastWebCall" value="{LastWebServiceXML}"/>
                  </map:transform>
               </map:act>
               <!-- Wrap the page in our HTML template -->
               <map:act type="astrogrid">
		           <map:transform src="common/xsl/astrogrid.xsl" label="003">
		              <!-- Add the rest of the page names -->
		              <map:parameter name="credential" value="{credential}" />
		              <map:parameter name="current-page"  value="agdataquery.html"/>
		              <map:parameter name="query-page"    value="agdataquery.html"/>
		              <map:parameter name="myspace-page"  value="agmyspace.html"/>
		              <map:parameter name="title-name"  value="Data Query"/>
		              <map:parameter name="home-page"     value="agindex.html"/>
		              <map:parameter name="admin-page"    value="agadministration.html"/>
		              <map:parameter name="help-page"     value="agdataqueryhelp.html"/>
		              <map:parameter name="registry-page" value="agregistry.html"/>
		              <map:parameter name="regadmin-page" value="agregadmin.html"/>
		              <map:parameter name="monitor-page"  value="agjobmonitor.html"/>
		              <map:parameter name="tools-page"    value="agtools.html"/>
		              <map:parameter name="logout-page"   value="aglogout.html"/>
		           </map:transform>
		       </map:act>
               <!-- Serialize as HTML -->
               <map:serialize type="html"/>
            </map:match>
            
         <!-- Credentials page -->
         <map:match pattern="agcredentials.html">
            <!-- Call our query action -->
            <map:act type="astrogrid-credentials">
               <!-- Set the session attribute to check for the user name -->
               <map:parameter name="user-param"  value="user"/>
               <!-- Generate our page XML -->
               <map:generate src="community/xsp/credentials.xsp" type="serverpages" label="000, 001"/>
               <!-- Convert the data into a page -->
               <map:transform src="community/xsl/credentials.xsl" label="002">
                  <map:parameter name="credential" value="{credential}"/>
               </map:transform>
            </map:act>
            <!-- Wrap the page in our HTML template -->
            <map:transform src="common/xsl/astrogrid.xsl" label="003">
               <!-- Add the rest of the page names -->
               <map:parameter name="current-page"  value="agcredentials.html"/>
               <map:parameter name="query-page"    value="agdataquery.html"/>
               <map:parameter name="myspace-page"  value="agmyspace.html"/>
               <map:parameter name="home-page"     value="agindex.html"/>
               <map:parameter name="help-page"     value="agdataqueryhelp.html"/>
               <map:parameter name="title-name"  value="Credentials"/>               
               <map:parameter name="registry-page" value="agregistry.html"/>
               <map:parameter name="regadmin-page" value="agregadmin.html"/>
               <map:parameter name="monitor-page"  value="agjobmonitor.html"/>
               <map:parameter name="tools-page"    value="agtools.html"/>
               <map:parameter name="admin-page"    value="agadministration.html"/>
               <map:parameter name="logout-page"   value="aglogout.html"/>
            </map:transform>
            <!-- Serialize as HTML -->
            <map:serialize type="html"/>
         </map:match>
            
            

            <!-- Explorer page -->
            <map:match pattern="agmyspace.html">
            <!-- Call our explorer action -->
               <map:act type="astrogrid-explorer">
                  <!-- Set the session attribute to check for the user name -->
                  <map:parameter name="user-param"  value="user"/>
                  <!-- Generate our page XML -->
                  <map:generate src="explorer/xsp/explorer.xsp"
                     type="serverpages" label="000, 001"/>
                  <!-- Convert the data into a page -->
                  <map:transform src="explorer/xsl/explorer.xsl" label="002">
                     <!-- Add the action params -->
                     <map:parameter name="action"  value="{action}"/>
                     <map:parameter name="confirm" value="{confirm}"/>
                     <!-- Add the explorer page names -->
                     <map:parameter name="explorer-page"
                        value="agmyspace.html"/>
                     <map:parameter name="votable-page"
                        value="agvotable.html"/>
					<map:parameter name="plot-page" value="agtopcat.html"/>
                  </map:transform>
               </map:act>
               <!-- Wrap the page in our HTML template -->
               <map:act type="astrogrid">
		           <map:transform src="common/xsl/astrogrid.xsl" label="003">
		              <!-- Add the rest of the page names -->
		              <map:parameter name="credential" value="{credential}" />
		              <map:parameter name="credential-page" value="agcredentials.html" />
                  <!-- Add the current page name -->
                  <map:parameter name="current-page" value="agmyspace.html"/>
                  <!-- Add the explorer page names -->
                  <map:parameter name="explorer-page" value="agmyspace.html"/>
                  <map:parameter name="votable-page"  value="agvotable.html"/>
                  <!-- Add the rest of the page names -->
                  <map:parameter name="home-page"     value="agindex.html"/>
                  <map:parameter name="title-name"  value="Myspace"/>
                  <map:parameter name="help-page"     value="agmyspacehelp.html"/>
                  <map:parameter name="registry-page" value="agregistry.html"/>
                  <map:parameter name="regadmin-page" value="agregadmin.html"/>
                  <map:parameter name="query-page"    value="agdataquery.html"/>
                  <map:parameter name="monitor-page"  value="agjobmonitor.html"/>
                  <map:parameter name="tools-page"    value="agtools.html"/>
	              <map:parameter name="admin-page"    value="agadministration.html"/>
                  <map:parameter name="logout-page"   value="aglogout.html"/>
               </map:transform>
               </map:act>
               <!-- Serialize as HTML -->
               <map:serialize type="html"/>
            </map:match>

            <!-- VoTable data pages -->
            <map:match pattern="agvotable.html">
               <map:act type="request">
                  <map:parameter name="parameters" value="true"/>
                  <map:generate src="{data}"/>
                  <!-- Convert the VoTable data into HTML -->
                  <map:transform src="explorer/xsl/votable.xsl">
                    <map:parameter name="explorer-page" value="agmyspace.html"/>
                    <map:parameter name="votable-page"  value="agvotable.html"/>
					<map:parameter name="plot-page" value="agtopcat.html"/>                    
                  </map:transform>
                      <map:act type="astrogrid">
                  <!-- Wrap the page in our HTML template -->
                  <map:transform src="common/xsl/astrogrid.xsl" label="003">
		              <map:parameter name="credential" value="{credential}" />
		              <map:parameter name="current-page"  value="agdataquery.html"/>
                  
                  <!-- Add the explorer page names -->
                   <map:parameter name="current-page"  value="agmyspace.html"/>
                   <map:parameter name="explorer-page" value="agmyspace.html"/>
                   <map:parameter name="votable-page"  value="agvotable.html"/>
                   <!-- Add the rest of the page names -->
                   <map:parameter name="home-page"     value="agindex.html"/>
                   <map:parameter name="help-page"     value="agmyspacehelp.html"/>
                   <map:parameter name="registry-page" value="agregistry.html"/>
                   <map:parameter name="regadmin-page" value="agregadmin.html"/>
                   <map:parameter name="query-page"    value="agdataquery.html"/>
                   <map:parameter name="title-name"  value="MySpace"/>                   
                   <map:parameter name="monitor-page"  value="agjobmonitor.html"/>
                   <map:parameter name="tools-page"    value="agtools.html"/>
                   <map:parameter name="logout-page"   value="aglogout.html"/>
    	              <map:parameter name="admin-page"    value="agadministration.html"/>
                   <map:parameter name="current-page" value="agmyspace.html"/>                   
                  </map:transform>
                  </map:act>
                  <!-- Serialize as HTML -->
                  <map:serialize type="html"/>
               </map:act>
            </map:match>

<!-- PJN -->
      		<!-- Workflow: Administer workflows page --> 
      		<!-- display without calling action -->
      		<map:match pattern="agjobmonitor.html" >
   	    	<map:generate src="workflow/xsp/workflow-administer.xsp" type="serverpages" />  
   			<map:transform src="workflow/xsl/workflow-administer.xsl" > 
   			  <map:parameter name="use-request-parameters" value="true"/>
          	  <!-- Add the action params -->
          	  <map:parameter name="action" value="{action}"/>
   		 	</map:transform>
        	<!-- Wrap the page in our HTML template -->
              <map:transform src="common/xsl/astrogrid.xsl" label="003">
		        <map:parameter name="credential" value="{credential}" />
		        <map:parameter name="current-page"  value="agdataquery.html"/>
                  
                  <!-- Add the explorer page names -->
                   <map:parameter name="current-page"  value="agmyspace.html"/>
                   <map:parameter name="explorer-page" value="agmyspace.html"/>
                   <map:parameter name="votable-page"  value="agvotable.html"/>
                   <!-- Add the rest of the page names -->
                   <map:parameter name="home-page"     value="agindex.html"/>
                   <map:parameter name="help-page"     value="agjobmonitorhelp.html"/>
                   <map:parameter name="registry-page" value="agregistry.html"/>
                   <map:parameter name="regadmin-page" value="agregadmin.html"/>
                   <map:parameter name="query-page"    value="agdataquery.html"/>
                   <map:parameter name="title-name"    value="Job Monitor"/>                   
                   <map:parameter name="monitor-page"  value="agjobmonitor.html"/>
                   <map:parameter name="tools-page"    value="agtools.html"/>
                   <map:parameter name="logout-page"   value="aglogout.html"/>
    	           <map:parameter name="admin-page"    value="agadministration.html"/>
                   <map:parameter name="current-page"  value="agjobmonitor.html"/>                   
                  </map:transform>
       		<!-- Serialize as HTML -->   		
   			<map:serialize type="html" /> 
      		</map:match>

		     <!-- Workflow: Administer workflows page -->           
    		  <!-- display and call action -->
		   	  <map:match pattern="agworkflow-administer.html" >
   	  	<map:act type="astrogrid-workflow">
   	    <map:parameter name="user-param" value="user" />
   	    <map:parameter name="community" value="community" />
   		<map:generate src="workflow/xsp/workflow-detail.xsp" type="serverpages" />  
   		<map:transform src="workflow/xsl/workflow-detail.xsl" >   		
   		    <map:parameter name="action" value="{action}" />
   		    <map:parameter name="ErrorMessage" value="{ErrorMessage}"/>
   		 </map:transform>
        <!-- Wrap the page in our HTML template -->
        <map:transform src="common/xsl/astrogrid.xsl" >       
        </map:transform>
       <!-- Serialize as HTML -->   		
   		<map:serialize type="html" />
   	   </map:act>
       </map:match>

<!-- PJN -->






            <!-- Explorer images -->
            <map:match pattern="explorer/images/*.gif">
               <map:read src="explorer/images/{1}.gif" mime-type="images/gif"/>
            </map:match>

            <!-- HTML pages -->
            <map:match pattern="*.html">
               <map:read mime-type="text/html" src="html/{1}.html"/>
            </map:match>

            <!-- Site XSP files -->
            <map:match pattern="*.xsp">
               <map:generate type="serverpages" src="xsp/{1}.xsp"/>
               <map:transform src="xsl/{1}.xsl"/> 
               <map:serialize type="html"/>
            </map:match>

         </map:match> <!-- On sessionstate "user" -->

<!-- Default page if no session "user" defined -->
         <map:match pattern="*.html">
            <map:read mime-type="text/html" src="html/agnotlogin.html"/>
         </map:match>
         
      </map:pipeline>
   </map:pipelines>
</map:sitemap>
