
<!--+
    |
    | Sub sitemap for MySpace Explorer.
    |
    ! Version 1.1
    !
    ! Authors: Roy Platon (r.t.platon@rl.ac.uk)
    ! Date: 15th December 2003
    +-->

<map:sitemap xmlns:map="http://apache.org/cocoon/sitemap/1.0">

<!-- ======================== Components ================================ -->

   <map:components>
      <map:generators default="file"/>
      <map:transformers default="xslt"/>
      <map:readers default="resource">
         <map:reader name="votable"
              pool-max="32"
              src="org.astrogrid.portal.cocoon.plugins.readers.VotableReader"/>
      </map:readers>
      <map:serializers default="html"/>
      <map:selectors default="browser"/>
      <map:matchers default="wildcard"/>
      <map:actions>
   	 <map:action name="astrogrid"
               src="org.astrogrid.portal.cocoon.common.AstrogridAction"/>
         <map:action name="astrogrid-explorer"
               src="org.astrogrid.portal.cocoon.explorer.ExplorerAction"/>
         <map:action name="astrogrid-query" 
	       src="org.astrogrid.portal.cocoon.query.QueryAction"/>
         <map:action name="astrogrid-admin" 
               src="org.astrogrid.portal.cocoon.community.AdministrationAction">
	    <map:action name="astrogrid-credentials"
                src="org.astrogrid.portal.cocoon.community.CredentialAction"/>
	    <map:action name="astrogrid-login"
            src="org.astrogrid.portal.cocoon.common.LoginAction"/>
	    <map:action name="astrogrid-workflow"
            src="org.astrogrid.portal.cocoon.workflow.design.DesignAction"/>

         <!-- AstroGrid QB actions. -->
         <map:action name="xml-validator" logger="sitemap.action.xml-validator"
            src="org.astrogrid.datacenter.cocoon.acting.XMLValidatorAction"/>

         <map:action name="save-adql" logger="sitemap.action.save-adql"
            src="org.astrogrid.datacenter.cocoon.acting.SaveAction"/>

         <map:action name="load-adql" logger="sitemap.action.load-adql"
            src="org.astrogrid.datacenter.cocoon.acting.LoadAction"/>

         <map:action name="test-adql" logger="sitemap.action.test-adql"
            src="org.astrogrid.datacenter.cocoon.acting.TestAction"/>
 
      </map:actions>
   </map:components>

<!-- =========================== Views =================================== -->

   <!-- Views for MySpace Explorer -->
   <map:views>
      <!-- Original XML displayed as XML -->
      <map:view name="000" from-label="000">
         <map:serialize type="xml"/>
      </map:view>
      <!-- Original XML, displayed as XML/HTML -->
      <map:view name="001" from-label="001">
         <!-- Convert into XML/HTML -->
         <map:transform src="common/xsl/xml-html.xsl"/>
         <map:serialize type="html"/>
      </map:view>
      <!-- XML processed into a page, displayed as XML/HTML -->
      <map:view name="002" from-label="002">
         <!-- Convert into XML/HTML -->
         <map:transform src="common/xsl/xml-html.xsl"/>
         <map:serialize type="html"/>
      </map:view>
      <!-- Page wrapped in our template, displayed as XML/HTML -->
      <map:view name="003" from-label="003">
         <!-- Convert into XML/HTML -->
         <map:transform src="common/xsl/xml-html.xsl"/>
         <map:serialize type="html"/>
      </map:view>
   </map:views>

<!-- ========================== Action sets ================================ -->

<!-- ========================== Resources ================================= -->

   <map:resources>
      <map:resource name="main-menu">
      <map:transform type="xslt" src="qb/style/adql.xsl" label="page"/>

      <!-- Wrap the page in the Portal template -->
      <map:act type="astrogrid">
         <map:transform src="common/xsl/astrogrid.xsl" label="final">
            <!-- Add the rest of the page names -->
            <map:parameter name="credential"    value="{credential}" />
            <map:parameter name="current-page"  value="agdataquery.html"/>
            <map:parameter name="query-page"    value="agdataquery.html"/>
            <map:parameter name="myspace-page"  value="agmyspace.html"/>
            <map:parameter name="title-name"    value="Data Query"/>
            <map:parameter name="home-page"     value="agindex.html"/>
            <map:parameter name="admin-page"    value="agadministration.html"/>
            <map:parameter name="help-page"     value="agdataqueryhelp.html"/>
            <map:parameter name="registry-page" value="agregistry.html"/>
            <map:parameter name="regadmin-page" value="agregadmin.html"/>
            <map:parameter name="monitor-page"  value="agjobmonitor.html"/>
            <map:parameter name="tools-page"    value="agtools.html"/>
            <map:parameter name="logout-page"   value="aglogout.html"/>
         </map:transform>
       </map:act>

       <!-- Serialize as HTML -->
       <map:serialize type="html"/> 
    </map:resource>
   </map:resources>

<!-- ========================== Pipelines ================================= -->

   <map:pipelines>
      <map:pipeline>

            <!-- Explorer page -->
            <map:match pattern="agmyspace.html">
            <!-- Call our explorer action -->
               <map:act type="astrogrid-explorer">
                  <!-- Set the session attribute to check for the user name -->
                  <map:parameter name="user-param"  value="user"/>
                  <!-- Generate our page XML -->
                  <map:generate src="explorer/xsp/explorer.xsp"
                     type="serverpages" label="xml, html"/>
                  <!-- Convert the data into a page -->
                  <map:transform src="explorer/xsl/explorer.xsl" label="page">
                     <!-- Add the action params -->
                     <map:parameter name="action"  value="{action}"/>
                     <map:parameter name="confirm" value="{confirm}"/>
                     <!-- Add the explorer page names -->
                     <map:parameter name="explorer-page"
                        value="agmyspace.html"/>
                     <map:parameter name="votable-page"
                        value="agvotable.html"/>
					<map:parameter name="plot-page" value="agtopcat.html"/>
                  </map:transform>
               </map:act>
               <!-- Wrap the page in our HTML template -->
               <map:act type="astrogrid">
		           <map:transform src="common/xsl/astrogrid.xsl" label="page">
		              <!-- Add the rest of the page names -->
		              <map:parameter name="credential" value="{credential}" />
		              <map:parameter name="credential-page"
Â                                   value="agcredentials.html" />
                  <!-- Add the current page name -->
                  <map:parameter name="current-page" value="agmyspace.html"/>
                  <!-- Add the explorer page names -->
                  <map:parameter name="explorer-page" value="agmyspace.html"/>
                  <map:parameter name="votable-page"  value="agvotable.html"/>
                  <!-- Add the rest of the page names -->
                  <map:parameter name="home-page"     value="agindex.html"/>
                  <map:parameter name="title-name"    value="Myspace"/>
                  <map:parameter name="help-page"
                                 value="agmyspacehelp.html"/>
                  <map:parameter name="registry-page" value="agregistry.html"/>
                  <map:parameter name="regadmin-page" value="agregadmin.html"/>
                  <map:parameter name="query-page"    value="agdataquery.html"/>
                  <map:parameter name="monitor-page"  value="agjobmonitor.html"/>
                  <map:parameter name="tools-page"    value="agtools.html"/>
	               <map:parameter name="admin-page"
                                 value="agadministration.html"/>
                  <map:parameter name="logout-page"   value="aglogout.html"/>
               </map:transform>
               </map:act>
               <!-- Serialize as HTML -->
               <map:serialize type="html"/>
            </map:match>

            <!-- VoTable data pages -->
            <map:match pattern="agvotable.html">
               <map:act type="request">
                  <map:parameter name="parameters" value="true"/>
                  <map:generate src="{data}"/>
                  <!-- Convert the VoTable data into HTML -->
                  <map:transform src="explorer/xsl/votable.xsl">
                    <map:parameter name="explorer-page" value="agmyspace.html"/>
                    <map:parameter name="votable-page"  value="agvotable.html"/>
					     <map:parameter name="plot-page" value="agtopcat.html"/>
                  </map:transform>
                  <map:act type="astrogrid">
                  <!-- Wrap the page in our HTML template -->
                    <map:transform src="common/xsl/astrogrid.xsl" label="final">
		                <map:parameter name="credential" value="{credential}" />
		                <map:parameter name="current-page"
                                     value="agdataquery.html"/>
                  
                  <!-- Add the explorer page names -->
                      <map:parameter name="current-page"
                                     value="agmyspace.html"/>
                      <map:parameter name="explorer-page"
                                     value="agmyspace.html"/>
                      <map:parameter name="votable-page"
                                     value="agvotable.html"/>
                  <!-- Add the rest of the page names -->
                      <map:parameter name="home-page"
                                     value="agindex.html"/>
                      <map:parameter name="help-page"
                                     value="agmyspacehelp.html"/>
                      <map:parameter name="registry-page"
                                     value="agregistry.html"/>
                      <map:parameter name="regadmin-page" 
                                     value="agregadmin.html"/>
                      <map:parameter name="query-page"
                                     value="agdataquery.html"/>
                      <map:parameter name="title-name"
                                     value="MySpace"/>
                      <map:parameter name="monitor-page"
                                     value="agjobmonitor.html"/>
                      <map:parameter name="tools-page"
                                     value="agtools.html"/>
                      <map:parameter name="logout-page"
                                     value="aglogout.html"/>
    	                <map:parameter name="admin-page" 
                                     value="agadministration.html"/>
                      <map:parameter name="current-page"
                                     value="agmyspace.html"/>
                    </map:transform>
                  </map:act>
                  <!-- Serialize as HTML -->
                  <map:serialize type="html"/>
               </map:act>
            </map:match>

            <!-- Explorer images -->
            <map:match pattern="explorer/images/*.gif">
               <map:read src="explorer/images/{1}.gif" mime-type="images/gif"/>
            </map:match>

            <!-- HTML pages -->
            <map:match pattern="*.html">
               <map:read mime-type="text/html" src="html/{1}.html"/>
            </map:match>

            <!-- Site XSP files -->
            <map:match pattern="*.xsp">
               <map:generate type="serverpages" src="xsp/{1}.xsp"/>
               <map:transform src="xsl/{1}.xsl"/> 
               <map:serialize type="html"/>
            </map:match>

<!-- Default page if no session "user" defined -->
         <map:match pattern="*.html">
            <map:read mime-type="text/html" src="html/agnotlogin.html"/>
         </map:match>
         
      </map:pipeline>
   </map:pipelines>
</map:sitemap>
