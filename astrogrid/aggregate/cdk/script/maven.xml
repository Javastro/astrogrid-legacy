<?xml version="1.0"?>
<!-- extension maven script - extends workflow and core cdk maven.xmls. -->
<project  xmlns:j="jelly:core"  xmlns:jsl="jelly:jsl" xmlns:jxml="jelly:xml">


<goal name="define-stylesheet">
	<jsl:stylesheet var="patch">
			<jsl:template match="jar[starts-with(@href,'astrogrid-cdk-')]"> <!-- gah- ${pom.artifactId} won't work here -->
		</jsl:template>
		<jsl:template match="jar[not(starts-with(@href,'astrogrid-cdk-')]">
			<jxml:copyOf select="." />
		</jsl:template>             
		<jsl:template match="information|security|application-desc|component-desc|property"> <!-- deliberately omitted j2se - as an extension descriptor shouldn't specify this -->
			<jxml:copyOf select="." />
		</jsl:template>
		<jsl:template match="jnlp|@*">
				<jxml:copy>
					<jsl:applyTemplates select="@* | node()" />
				</jxml:copy>
		</jsl:template>
		<jsl:template match="resources">
			<jxml:copy>
				<jxml:element name="extension">
					<jxml:attribute name="name">Astrogrid Workflow CDK${jnlpVersion}</jxml:attribute>
					<jxml:attribute name="href">http://software.astrogrid.org/jnlp/${subPath}astrogrid-cdk-workflow/astrogrid-cdk-workflow.jnlp</jxml:attribute>
				</jxml:element>
				<jsl:applyTemplates select="@* | node()" />
			</jxml:copy>
		</jsl:template>
	</jsl:stylesheet>
	</goal>


</project>
