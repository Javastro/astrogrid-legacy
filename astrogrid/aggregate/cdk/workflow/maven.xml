<?xml version="1.0"?>
<!-- extension maven script  - need to look in cdk/core for actions this maven.xml is extending.-->
<project xmlns:j="jelly:core"  xmlns:jsl="jelly:jsl" xmlns:jxml="jelly:xml">



        <!-- just define a new stylesheet to use to munge the jnlp
	     	- everything else works as-is. which is nice -->
<goal name="define-stylesheet">
	<echo>defining stylesheet for Workflow CDK</echo>
<jsl:stylesheet var="patch">
	<jsl:template match="jar[starts-with(@href,'astrogrid-cdk-')]"> <!-- gah- ${pom.artifactId} won't work here -->
	</jsl:template>
	<jsl:template match="jar[not(starts-with(@href,'astrogrid-cdk-')]">
		<jxml:copyOf select="." />
	</jsl:template>
	<jsl:template match="information|security|application-desc|component-desc|property"> <!-- deliberately omitted j2se - as an extension descriptor shouldn't specify this -->
		<jxml:copyOf select="." />
	</jsl:template>
	<jsl:template match="jnlp|@*">
			<jxml:copy>
				<jsl:applyTemplates select="@* | node()" />
			</jxml:copy>
	</jsl:template>
	<jsl:template match="resources">
		<jxml:copy>
			<jxml:element name="extension">
				<jxml:attribute name="name">Astrogrid Core CDK${jnlpVersion}</jxml:attribute>
				<jxml:attribute name="href">http://software.astrogrid.org/jnlp/${subPath}astrogrid-cdk-core/astrogrid-cdk-core.jnlp</jxml:attribute>
			</jxml:element>
			<jsl:applyTemplates select="@* | node()" />
		</jxml:copy>
	</jsl:template>
</jsl:stylesheet>
</goal>



</project>
