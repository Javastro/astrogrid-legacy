<?xml version="1.0"?>
<!-- $Id: maven.xml,v 1.6 2004/12/08 11:02:46 jdt Exp $ -->
<!-- extension maven script -->
<project xmlns:maven="jelly:maven">
	<!-- astrogrid goals for nightly build -->
	<goal name="astrogrid-clean" prereqs="clean"/>
	<goal name="astrogrid-deploy-site" prereqs="astrogrid-build-site">
		<attainGoal name="site:sshdeploy"/>
	</goal>
	<goal name="astrogrid-build-site">
		<attainGoal name="site"/>
	</goal>
	<goal name="astrogrid-deploy-snapshot">
		<echo message="nothing to do"/>
	</goal>
	<goal name="astrogrid-install-snapshot">
		<echo message="nothing to do"/>
	</goal>
	<goal name="astrogrid-deploy-artifact">
		<echo message="nothing to do"/>
	</goal>
	<goal name="astrogrid-install-artifact">
	<echo>Trying to build EVERYTHING!</echo><!--,filestore/*/project.xml,jes/project.xml,jes/delegate-project.xml-->
	   <maven:reactor
	     basedir="${basedir}"
	     postProcessing="false"
	     includes="common/project.xml,workflow-objects/project.xml,ui/project.xml,registry/*/project.xml"
	     excludes="registry/maven/project.xml,eXist/maven/project.xml"			
	     goals="astrogrid-install-artifact"
	     banner="Installing all artifacts...."
	     ignoreFailures="false" />
	</goal>
	<!--
	  This pregoal takes any simple html docs in the xdocs folder and turns them into xdoc xml,
	  before they are turned back into maven-style html docs.  Why?  html is easier to write in
	  a WYSIWIG editor than xdoc xml
     -->
	<preGoal name="xdoc:jelly-transform">
	    <attainGoal name="html2xdoc"/>
	</preGoal>
	
	<goal name="copy-monster-source-tree">
	    <copy todir="${basedir}/monster">
	        <mapper type="regexp" from="^(.*).java(.*)\.java$$" to="all/\2\.java"/>
	        <fileset dir="${basedir}">
	          <include name="**/src/java/org/astrogrid/**/*.java"/>
	          <!--include name="**/test/java/org/astrogrid/**/*.java"/-->
	          <exclude name="**/monster/**"/>
	        </fileset>
	    </copy>
	</goal>
	<!-- We dont want to inflict this on every poor bugger, so hope this is early enough in the build cycle -->
	<preGoal name="maven-javadoc-plugin:register">
		<attainGoal name="copy-monster-source-tree"/>"
	</preGoal>
</project>