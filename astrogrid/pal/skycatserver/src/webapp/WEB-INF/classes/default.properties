####################################################################
###
### Default configuration file for DSA/catalog servers
###
####################################################################
#
# By default, this file is installed in your DSA/catalog webapp's
# WEB-INF/classes directory, and is called "default.properties".
# By editing this file, you can configure the system properties for
# your DSA/catalog installation.
#
# However, if you customise this file, we recommend KEEPING A 
# BACKUP COPY OF IT SOMEWHERE OUTSIDE OF THE DSA/catalog WEBAPP.
# If you don't do this, your configuration information WILL BE LOST
# if the webapp is undeployed or upgraded. 
#
# Alternatively, if you are familiar with tomcat, you can move the 
# properties file outside the webapp, and use a tomcat environment
# property to specify where the properties file can be found; simply 
# set the property 'astrogrid.config.filename' for the installed
# webapp to the fully-qualified location of the properties file 
# (and be sure the file is in a location that is readable by tomcat).
# You can read more about this on the "Configuring your DSA/catalog"
# page in your installed DSA/catalog webapp.
#
#
# IMPORTANT NOTE ON DSA/catalog installation. 
# -------------------------------------------
# Note that your DSA/catalog should be installed (or accessible, e.g.
# via using httpd request forwarding) on either port 80 or port 8080 
# for full Virtual Observatory interoperability.
#
#
# Notes on the format of this file:
# ---------------------------------
#
# Comments in this file are preceded by the '#' character.
#
# Sample or disabled properties are preceded by the '!' character.
#
# Values which need to be replaced by a suitable local datum are
# enclosed in curly brackets, e.g. {replace_me}
#
#
# There are a number of properties to be configured, and as far as
# possible they are grouped together in logical collections.
#
# This file is intended to be self-documenting;  if you have 
# suggestions for clarifications or enhancements, please send 
# them to astrogrid_dsa@star.le.ac.uk.
#
####################################################################

# ==================================================================
# CRITICAL SETTINGS
# =================
# 
# All the properties in this file are important, but these two are 
# particularly critical for the operation of DSA/catalog self-tests.
#
#
# ----------
# This property sets the URL on which your DSA/catalog can be accessed.
# This URL MUST BE GLOBALLY VISIBLE as it will be used to tell the 
# Virtual Observatory how to reach your DSA/catalog;  a localhost 
# address will not work.  Uncomment the property below and configure
# it with the appropriate values.
# Example:  
#  datacenter.url=http://host.dept.uni.ac.uk:8080/astrogrid-dsa-catalog
# ----------

# This is a dummy value for use with the test SampleStars plugin described 
# below.  THIS VALUE IS FOR SELF-TEST PURPOSES ONLY;  localhost addresses
# cannot be used for live DSA/catalog installations, and this address 
# probably does not correspond to the local address of your installed
# webapp anyway.

datacenter.url=http://localhost:8080/astrogrid-dsa-catalog/

# When you come to connect your own RDBMS, you'll need to comment out the
# test entry above and provide the real URL of your service below.

!datacenter.url=http://{your_full_host_address}:{your_port_number}/{path_to_your_webapp}/


# ----------
# This property sets the location of the "metadoc file" for your data.
# This file contains an XML description of the format of your data
# (tables and column descriptions, with additional information about
# IVOA UCDs etc).
# ----------
#
# This value will work with the test SampleStars plugin described below.

datacenter.metadoc.file=samplestars.metadoc.xml

# When you come to connect your own RDBMS, you'll need to comment out
# the sample entry above, provide your own metadoc description and 
# specify its location.
#
# We recommend CONFIGURING THIS SETTING LAST.  If you first configure
# access to your database (described below), and restart the DSA/catalog 
# webapp or tomcat, then you can use the "admin/GenerateMetaDoc" page in 
# this DSA/catalog's web interface to create a skeleton metadoc file 
# for your data, by visiting this address (customised with your local 
# installation details):
# 
#    http://{your_full_host_address}:{your_port_number}/{path_to_your_webapp}/admin/generateMetaDoc
#
# Note that at this point, some of the DSA/catalog self-tests will be 
# failing because an inconsistent metadoc file is in use; you can ignore 
# this failure temporarily.  

# The skeleton metadoc file you have thus created will require some 
# manual enhancement, as described in this DSA/catalog installation's 
# "Configuring your DSA/catalog" web interface pages:
#
#    http://{your_full_host_adddress}:{your_port_number}/{path_to_your_webapp}/configure.jsp
# 
# Once you have edited the metadoc file, put it somewhere outside the 
# installed webapp and then make sure you supply a fully-qualified path 
# to it in the property below, and that it has file permissions allowing 
# tomcat to read it.

!datacenter.metadoc.file={/full/path/to/your.metadoc.xml}


# ==================================================================
# DATABASE CONNECTION SETTINGS
# ============================
#
# Properties involved in connecting to the dataset in the RDBMS.
#
# The DSA/catalog architecture is "pluggable", i.e. "plugin" modules 
# can be written to handle local data connection requirements without 
# revision to the core DSA/catalog engine.
#
# Two standard plugins are currently supplied, which should hopefully
# be adequate for most users.  
#
# For testing purposes, a test plugin with classname
# 'org.astrogrid.tableserver.test.SampleStarsPlugin' is supplied;  
# this creates and accesses a small test database using the HSQLDB java
# database that is included in the DSA/catalog installation.
#
# For access to your own RDBMS data, a JDBC plugin is supplied
# with classname 'org.astrogrid.tableserver.jdbc.JdbcPlugin', to
# allow the DSA/catalog to connect to your database via the JDBC 
# architecture.
# (NB This plugin requires that your RDBMS vendor supplies a JDBC driver 
# for the RDBMS;  as far as we know, all the major vendors do this).
# If your RDBMS doesn't support JDBC, you will need to provide a 
# customised plugin; you may wish to contact astrogrid_dsa@star.le.ac.uk
# for some advice with this.
#
# ------------------------------------------------------------------ 
# An example plugin for initial tests 
# ------------------------------------
# These properties activate the default test plugin.
# You should comment them out once you are ready to connect to your
# real data instead of a test infrastructure.
#
# More detailed comments for these properties are given below in
# the JDBC plugin settings.

datacenter.querier.plugin=org.astrogrid.tableserver.test.SampleStarsPlugin
datacenter.sqlmaker.xslt=HSQLDB-1.8.0.xsl
db.trigfuncs.in.radians=true


# ------------------------------------------------------------------ 
# A JDBC plugin for real RDBMS access
# ----------------------------------
#
# We hope that this JDBC plugin should work for most common RDBMS systems.
#
# Comment out the properties for the test plugin above, and uncomment the
# relevant properties below (by removing the leading '!' character) to use JDBC.
#
# Note that you will also need to copy the JDBC jar for your RDBMS 
# into your DSA/catalog webapp's WEB-INF/lib directory (remember to 
# restart the webapp after doing so, to be sure the jar is in the
# webapp's classpath).

# ----------
# This property tells the DSA to use the JDBC Plugin
# ----------

!datacenter.querier.plugin=org.astrogrid.tableserver.jdbc.JdbcPlugin

# ----------
# This property tells the plugin whether the RDBMS expects trigonometric
# function arguments in radians or not (set to "false" if RDBMS trig 
# functions use degrees).
# ----------

!db.trigfuncs.in.radians=true

# ----------
# These properties tell the DSA what username and password to use for JDBC 
# access to the RDBMS (this user account obviously needs to exist/be 
# configured within your RDBMS).
# IT IS STRONGLY ADVISED THAT THE JDBC USER ACCOUNT BE READ-ONLY - so
# the JDBC username should have no permission to modify the database.
# ----------

!datacenter.plugin.jdbc.user={jdbc_username}
!datacenter.plugin.jdbc.password={jdbc_password}

# ----------
# These properties tell the JDBC infrastructure how to connect to the
# RDBMS.  Insert the details of your JDBC driver class and connection URL 
# (you can base this on one of the templates below if using one of the
# specified RDBMS systems, and/or refer to the JDBC section of your RDBMS 
# documentation.)
# ----------

# Template JDBC driver/URL properties for Microsoft SQLServer
# Likely to work with other versions of SQLServer too
#
!datacenter.plugin.jdbc.drivers=com.microsoft.jdbc.sqlserver.SQLServerDriver
!datacenter.plugin.jdbc.url=jdbc:microsoft:sqlserver://{hostname};DatabaseName={databasename}

# Template JDBC driver/URL properties for MySQL 4.1.16 
# Likely to work with other versions of MySQL too
#
!datacenter.plugin.jdbc.drivers=com.mysql.jdbc.Driver
!datacenter.plugin.jdbc.url=jdbc:mysql://{hostname}/{databasename}"

# Template JDBC driver/URL properties for PostgreSQL
# Likely to work with other versions of PostgreSQL too
#
!datacenter.plugin.jdbc.drivers=org.postgresql.Driver
!datacenter.plugin.jdbc.url=jdbc:postgresql://{hostname}/{databasename}

# Template JDBC driver/URL properties for HSQLDB 1.8.0
!datacenter.plugin.jdbc.drivers=org.hsqldb.jdbcDriver
# For an in-memory database
!datacenter.plugin.jdbc.url=jdbc:jdbc:hsqldb:.;shutdown=true
# For an on-disk database
!datacenter.plugin.jdbc.url=jdbc:jdbc:hsqldb:{databasename};shutdown=true

# ----------
# Settings for SQL translation.
# The JDBC plugin by default uses an XSLT-based mechanism to produce
# suitable SQL queries from incoming ADQL/XML queries.  We need to
# specify which XSLT stylesheet the RDBMS should use.  
# The following stylesheets ship with the DSA;  choose the one most
# appropriate to your RDBMS.  If your DSA fails its SQL syntax tests,
# you will need to provide a customised stylesheet that produces the
# correct SQL.
# ----------

# For Microsoft SQLServer 8.00 
# (likely to work with other versions of SQLServer too)
!datacenter.sqlmaker.xslt=SQLSERVER-8.00.xsl

# For MySQL 4.1.16 
# (likely to work with other versions of MySQL too)
# (This is a good one to try if your RDBMS is not one of the ones listed).
!datacenter.sqlmaker.xslt=MYSQL-4.1.16.xsl

# For PostgreSQL 7.2.3 
# (likely to work with other versions of PostgreSQL too)
!datacenter.sqlmaker.xslt=POSTGRES-7.2.3.xsl

# For HSQLDB 1.8.0
!datacenter.sqlmaker.xslt=HSQLDB-1.8.0.xsl

# For a locally-customised stylesheet stored on the local filesystem
!datacenter.sqlmaker.xslt=/full/path/to/your/stylesheet.xsl


# ==================================================================
# RESOURCE RESTRICTION SETTINGS
# =============================
# 
# These properties allow you to set crude usage limitations to avoid 
# overloading or large-scale data-mining of your DSA/catalog, if you wish.

# Limits number of rows that can be returned by any single query 
# (equivalent to using SQL "TOP" or "LIMIT").   
# NB A value of 0 indicates no limit.  
datacenter.max.return=50000

# Limits number of queries to be processed simultaneously (queries in 
# excess of this will be queued until one or more of the active queries 
# completes).
datacenter.max.queries=4

# Limits run-time for each query.  
# NB A value of 0 indicates no limit
#
# Note that setting this value to some finite time will NOT cause 
# the SQL query running on the actual RDBMS to be terminated;  it
# will just kill off the datacenter's monitoring and results 
# delivery for any query has been running for more than the 
# specified time.
datacenter.sql.timeout=0


# ==================================================================
# SELF-TEST SETTINGS
# ==================
# The DSA/catalog server has a suite of self-tests designed to 
# check that ADQL/XML queries are being translated into SQL compatible
# with your back-end RDBMS.
#
# The self-test infrastructure uses a series of templated ADQL/XML 
# queries; it plugs a real table name and real column names into
# the templates in order to produce SQL that will actually run against
# your data in your RDBMS.
#
# The properties below tell the self-test infrastructure the names of 
# the table and columns to use in populating the templated queries.
# When you configure access to your real RDBMS, you should configure the 
# properties below with real table and column names from your database.
#
# The default properties below will work with the SampleStars plugin
# for initial tests.

datacenter.self-test.table=SampleStars
datacenter.self-test.column1=RA
datacenter.self-test.column2=DEC

# When you configure access to your real RDBMS, you should replace 
# the self-test properties with real table and column names as below.
# The columns chosen should be some kind of floating-point number;
# RA and DEC are ideal if they exist in your database.
# If your data has no floating-point columns, you can try integer
# columns instead;  however, some syntax self-tests may fail if your
# RDBMS is picky about automatic type promotions.

!datacenter.self-test.table={a_table_in_your_database}
!datacenter.self-test.column1={a_floating_point_column_in_that_table}
!datacenter.self-test.column2={another_floating_point_column_in_that_table}


# ==================================================================
# CONE-SEARCH INTERFACE SETTINGS
# ==============================
# The DSA/catalog server provides an IVOA "cone-search" interface.
# This simple interface accepts a Right Ascension, Declination and 
# search radius in decimal degrees.
#
# Supplying a conesearch interface to your data probably only makes sense
# if that data is an astronomical catalogue with RA and Dec coordinates for 
# each row.  If you don't want to provide this interface, set this 
# property to false.
datacenter.implements.conesearch=true

# If conesearch is enabled above, the following properties configure how 
# an incoming conesearch should be interpreted, namely which table in the 
# database it should be run against, which columns in that table are the 
# RA and Dec coordinates, and what units those columns are in (degrees or 
# radians).
# Unfortunately at present, conesearch can only be configured for a 
# single table;  future versions of DSA/catalog may permit individual
# conesearch interfaces to be set up for >1 table in your database.
#
# These values will work with the SampleStars plugin for initial tests:
conesearch.table=SampleStars
conesearch.ra.column=RA
conesearch.dec.column=DEC
conesearch.columns.units=deg

# When you configure access to your real RDBMS, you should replace 
# the above sample properties with real table and column names as below.
# The 'conesearch.columns.units' property should be set to 'deg'
# for degrees or 'rad' for radians.
#
!conesearch.table={a_table_in_your_database}
!conesearch.ra.column={RA_column_in_that_table}
!conesearch.dec.column={Dec_column_in_that_table}
!conesearch.columns.units={your_RA_Dec_units}


# ==================================================================
# VIRTUAL OBSERVATORY SETTINGS
# ============================
# To be useful as part of the Virtual Observatory, this DSA/catalog
# server needs to publish some information about itself.  
# These properties are used to describe the DSA/catalog's interfaces 
# and data so that it can be discovered and utilised by Virtual 
# Observatory tools and their human users.

# ----------
# These two properties are aimed at human readers - change them
# to reflect your own installation details.  The sample entries 
# below describe the default test configuration of the DSA/catalog 
# installation.
# ----------
datacenter.name={AstroGrid DSA/catalog running test dataset}
datacenter.description={This is a default (unconfigured) DSA/catalog installation.  It accesses a small HSQLDB database containing fictitious tables of stars and galaxies for testing and demonstration purposes.}

# ----------
# The following settings are for configuring "VOResources", which are XML 
# descriptions of the DSA/catalog server, its interfaces and data,
# intended to be stored in VO-compliant "registries" of such descriptions.
#
# These settings are very important, as together they comprise a unique
# identifier for this resource in the Virtual Observatory.
# The Authority ID is a unique identifier for your organisational unit,
# e.g. star.le.ac.uk);  see 
# http://wiki.astrogrid.org/bin/view/Deploy/InstallationNotesAuthorityID
# for more about authority IDs.
# The Resource Key is a unique identifier for this particular resource,
# e.g. USNOB_DSA.  Your Authority ID must have be no other resources with 
# this name;  the Authority ID / Resource Key pair must be globally unique.

# These are test values, which work with the default test plugin
datacenter.authorityId=astrogrid.org
datacenter.resourceKey=test-dsa-catalog

# You need to comment out the test values, and replace them with your own 
# authority ID and resource key:
!datacenter.authorityId={please.specify.me}
!datacenter.resourceKey={SpecifyMe}

# These settings provide helpful information to human users of the VO.
datacenter.publisher={Organisation making this DSA/catalog available}
datacenter.contact.name={Name of DSA/catalog administrator}
datacenter.contact.email={Email address of DSA/catalog administrator}

# ----------
# The DSA/catalog server has a pluggable architecture for VOResource
# generation;  a particular plugin is intended to produce a particular 
# style of Virtual Observatory resource registration.
# Multiple plugins can be specified, for example:
#
#   datacenter.resource.plugin.1=first.plugin.class
#   datacenter.resource.plugin.2=second.plugin.class
#   datacenter.resource.plugin.3=third.plugin.class
#
# (please number these properties in sequence, starting from 1).
# At present, for most purposes, only the TabularDbResources plugin below 
# is needed.  This will probably change as new Registry standards emerge.
#
# This plugin generates and includes TabularDBResource XML registration data
# in this DSA/catalog's Registry metadata.
#
datacenter.resource.plugin.1=org.astrogrid.tableserver.metadata.TabularDbResources

# To publish other XML Resource documents that are stored in local or internet 
# files, configure this set of properties:
#
!datacenter.resource.plugin.2=org.astrogrid.dataservice.metadata.FileResourcePlugin
!datacenter.resource.filename.1=
!datacenter.resource.url=

# Authority IDs (as discussed above) need themselves to have a VOResource
# entry in a VO registry;  each entry has one particular registry that is 
# its "managing registry".  The Authority ID only needs to be registered
# once;  if your organisation has a pre-existing Authority ID, it is 
# probably already registered.  However, if you are creating a new Authority
# ID specifically for this DSA/catalog installation, you can use this plugin
# to register your Authority ID as well as your DSA/catalog VOResource data.
#
!datacenter.resource.plugin.3=org.astrogrid.datacenter.metadata.AuthorityConfigPlugin


# ==================================================================
# REGISTRY SERVICES
# =================
#
# This DSA/catalog installation needs to register its own resources in
# the same "Publishing registry" that publishes the installation's 
# Authority ID registration (see Authority ID discussion above).
#
# Additionally, this installation will sometimes need to search a VO 
# "Querying registry" in order to resolve VOSpace addresses (such as 
# destination IVORNs where it should put query results).
#
# This is the "publishing registry" used when this DSA/catalog needs to 
# register its resources.  It must be the same registry where the DSA/catalog's
# Authority ID is registered.  (Note that the admin endpoint uses the
# RegistryUpdate interface of this registry.)
org.astrogrid.registry.admin.endpoint=http://galahad.star.le.ac.uk:8081/astrogrid-registry/services/RegistryUpdate

# This is the "querying registry" used to resolve VOSpace addresses.  
# It should be reasonably high performance and/or close by, but it doesn't 
# have to belong to your organisation or manage your Authority ID.
# (Note that the query endpoint uses the RegistryQuery interface of this 
# registry.)
org.astrogrid.registry.query.endpoint=http://galahad.star.le.ac.uk:8081/astrogrid-registry/services/RegistryQuery

# This is the alternative querying registry, used if the main querying 
# registry is unavailable.
org.astrogrid.registry.query.altendpoint=http://hydra.star.le.ac.uk:8080/astrogrid-registry/services/RegistryQuery


# ==================================================================
# MISC. OTHER PROPERTIES
# ======================
#
# DON'T CHANGE OR REMOVE THIS ONE!  It's a required property.
cea.component.manager.class=org.astrogrid.dataservice.service.cea.DatacenterCEAComponentManager

# ----------
# These set whether CEA tasks should be stored in memory or on disk, 
# and if so, where.  The default is in memory, so you only need to 
# uncomment/configure these properties if you want the CEA interface 
# to store jobs to disk.
# ----------
!cea.persistence.backend=file
!cea.filestore.basedir=/tmp/  (defaults to container's default directory)
