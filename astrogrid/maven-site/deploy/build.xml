<!-- $Id: build.xml,v 1.4 2003/12/29 00:34:05 jdt Exp $ -->
<!--
	Example Deploy Script for Astrogrid War files
	This script uses the Tomcat Manager to deploy war files built nightly by Maven
	This could also be run nightly following the maven run.
	Note that these ant tasks require the catalina-ant.jar (found in your tomcat download) to be placed in
	your ant lib folder.  If you're running ant from Eclipse this is likely to be something like:
	C:\Java\eclipse\plugins\org.apache.ant_1.5.3
	-->
	


<project name="DeployWars" default="DeployTheLot" basedir=".">

  <!-- URLs of the wars-->
  <property name="mavenURL" value="http://www.astrogrid.org/maven/"/>

  <property name="PALwarURL"     value="${mavenURL}/astrogrid-datacenter/wars/pal-SNAPSHOT.war"/>
  <property name="JESwarURL"     value="${mavenURL}/astrogrid-jes/wars/astrogrid-jes-SNAPSHOT.war"/>
  <property name="MySpacewarURL"     value="${mavenURL}/astrogrid-myspace/wars/astrogrid-mySpace-SNAPSHOT.war"/>

  <!-- Configure properties to access the Manager applications -->
  
  <!--Deployment machines see http://wiki.astrogrid.org/bin/view/Astrogrid/Itn04IREnvironment -->
  <property name="url1"      value="vm05.astrogrid.org:8080/manager"/>
  <property name="username1" value="tomcat"/>
  <property name="password1" value="secret"/><!--fill this in (can't be stored in CVS for security reasons)-->
  <property name="url2"      value="http://astrogrid2.jb.man.ac.uk:8080/manager"/>
  <property name="username2" value=""/>
  <property name="password2" value=""/><!--fill this in (can't be stored in CVS for security reasons)-->
  <property name="url3"      value="http://astrogrid3.jb.man.ac.uk:8080/manager"/>
  <property name="username3" value=""/>
  <property name="password3" value=""/><!--fill this in (can't be stored in CVS for security reasons)-->
  <property name="url4"      value="http://astrogrid4.jb.man.ac.uk:8080/manager"/>
  <property name="username4" value=""/>
  <property name="password4" value=""/><!--fill this in (can't be stored in CVS for security reasons)-->

  <!-- Configure the custom Ant tasks for the Manager application -->
  <taskdef name="deploy"    classname="org.apache.catalina.ant.DeployTask"/>
  <taskdef name="list"      classname="org.apache.catalina.ant.ListTask"/>
  <taskdef name="reload"    classname="org.apache.catalina.ant.ReloadTask"/>
  <taskdef name="resources" classname="org.apache.catalina.ant.ResourcesTask"/>
  <taskdef name="roles"     classname="org.apache.catalina.ant.RolesTask"/>
  <taskdef name="start"     classname="org.apache.catalina.ant.StartTask"/>
  <taskdef name="stop"      classname="org.apache.catalina.ant.StopTask"/>
  <taskdef name="undeploy"  classname="org.apache.catalina.ant.UndeployTask"/>
  <taskdef name="remove"  classname="org.apache.catalina.ant.RemoveTask"/>

<!--==================================================================================-->
  <!-- JES-->
    <property name="JESPath"     value="/jes-SNAPSHOT"/>
    <target name="DeployJES" description="Obtain the latest jes war and deploy it to tomcat">
		<deploy url="${url1}" path="${JESPath}"
		    war="${JESwarURL}"
		    username="${username1}" password="${password1}" />
    </target>
    
    <target name="UndeployJES">
		<remove url="${url1}" path="${JESPath}"
		    username="${username1}" password="${password1}" />
	</target>
	
    <target name="RedeployJES" depends="UndeployJES, DeployJES"/>

<!--==================================================================================-->

<!--==================================================================================-->
  <!-- MySpace-->
    <property name="MySpacePath"     value="/mySpace-SNAPSHOT"/>
    <target name="DeployMySpace" description="Obtain the latest MySpace war and deploy it to tomcat">
		<deploy url="${url1}" path="${MySpacePath}"
		    war="${MySpacewarURL}"
		    username="${username1}" password="${password1}" />
    </target>
    
    <target name="UndeployMySpace">
		<remove url="${url1}" path="${MySpacePath}"
		    username="${username1}" password="${password1}" />
	</target>
	
    <target name="RedeployMySpace" depends="UndeployMySpace, DeployMySpace"/>

<!--==================================================================================-->

<!--==================================================================================-->
  <!-- PAL/Vizier-->
  <!-- need to copy across cds delegate too?-->
    <property name="PALVizierPath"     value="/pal-SNAPSHOT"/>
    <target name="DeployPALVizier">
		<deploy url="${url3}" path="${PALVizierPath}"
		    war="${PALwarURL}"
		    username="${username3}" password="${password3}" />
    </target>
    
    <target name="UndeployPALVizier">
		<remove url="${url3}" path="${PALVizierPath}"
		    username="${username3}" password="${password3}" />
	</target>
	
    <target name="RedeployPALVizer" depends="UndeployPALVizier, DeployPALVizier"/>

<!--==================================================================================-->

  <!-- PAL/Merlin-->
    <property name="PALMerlinpath"     value="/pal-SNAPSHOT"/>
    <target name="DeployPALMerlin" description="Obtain the latest PAL war and deploy it to tomcat">
		<deploy url="${url4}" path="${PALMerlinpath}"
		    war="${PALwarURL}"
		    username="${username4}" password="${password4}" />
    </target>
    
    <target name="UndeployPALMerlin">
		<remove url="${url4}" path="${PALMerlinpath}"
		    username="${username4}" password="${password4}" />
	</target>
	
    <target name="RedeployPALMerlin" depends="UndeployPALMerlin, DeployPALMerlin"/>

<!--==================================================================================-->
	<target name="DeployTheLot" depends="DeployPALMerlin,DeployPALVizier,DeployJES"/>
<!--==================================================================================-->

	<!--see what's deployed where-->
	<target name="List1">
		<list url="${url1}" 
		    username="${username1}" password="${password1}" />	
	</target>	
	<target name="List2">
		<list url="${url2}" 
		    username="${username2}" password="${password2}" />	
	</target>
	<target name="List3">
		<list url="${url3}" 
		    username="${username3}" password="${password3}" />	
	</target>
	<target name="List4">
		<list url="${url4}" 
		    username="${username4}" password="${password4}" />	
	</target>
	<target name="ListAll" depends="List1,List2,List3,List4"/>
</project>
