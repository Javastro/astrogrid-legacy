<HTML>
<STYLE>
A:link {text-decoration: underline; color: darkmagenta;}
A:visited {text-decoration: underline; color: darkmagenta;}
#f0 { font-family: "Helvetica"; font-size: 10pt;  }
#f1 { font-family: "SansSerif"; font-size: 10pt;  }
#f2 { font-family: "SansSerif"; font-size: 8pt;  }
#f3 { font-family: "SansSerif"; font-size: 14pt; font-style: italic; font-weight: bold; color: #FFFFFF;  }
#f4 { font-family: "SansSerif"; font-size: 12pt; font-weight: bold; color: #FFFFFF;  }
#f5 { font-family: "SansSerif"; font-size: 12pt; font-style: italic;  }
#f6 { font-family: "SansSerif"; font-size: 12pt; font-weight: bold;  }
#f7 { font-family: "SansSerif"; font-size: 8pt; font-weight: bold;  }
#f8 { font-family: "SansSerif"; font-size: 10pt; font-style: italic; font-weight: bold;  }
#f9 { font-family: "SansSerif"; font-size: 11pt; font-style: italic; font-weight: bold;  }
#f10 { font-family: "SansSerif"; font-size: 10pt; font-style: italic;  }
#f11 { font-family: "SansSerif"; font-size: 10pt; font-weight: bold;  }
#f12 { font-family: "SansSerif"; font-size: 9pt; font-style: italic; font-weight: bold;  }
#f13 { font-family: "SansSerif"; font-size: 9pt; font-weight: bold;  }
#f14 { font-family: "SansSerif"; font-size: 9pt;  }
#f15 { font-family: "SansSerif"; font-size: 8pt; font-style: italic;  }
#f16 { font-family: "monospace"; font-size: 9pt;  }
#f17 { font-family: "SansSerif"; font-size: 9pt; font-weight: bold; color: #800080;  }
#f18 { font-family: "SansSerif"; font-size: 8pt; font-style: italic; font-weight: bold;  }
</STYLE>
<BODY BGCOLOR="white">
<BASEFONT ID="f0">
<DIV STYLE="margin-left:2pt;margin-top:5pt;"><IMG SRC="doc-images/ActivityDiagram4.png"> <FONT ID="f6">Activity Diagram</FONT> <FONT ID="f5"><U>execute-query-workflow</U></FONT></DIV>
<DIV STYLE="margin-left:3pt;margin-top:4pt;"><FONT ID="f2">package:</FONT> <FONT ID="f7"><A HREF="Package.html">use-cases</A></FONT></DIV>
<DIV STYLE="margin-top:16pt;margin-left:2pt;"><IMG SRC="doc-images/execute-query-workflow_ActivityDiagram.gif" USEMAP="#M1"><MAP NAME="M1"><AREA SHAPE="rect" COORDS="40,270,228,299" HREF="execute-query-workflow.html#R1"><AREA SHAPE="rect" COORDS="40,190,228,219" HREF="execute-query-workflow.html#R2"><AREA SHAPE="rect" COORDS="40,110,228,139" HREF="execute-query-workflow.html#R3"><AREA SHAPE="rect" COORDS="42,35,230,64" HREF="execute-query-workflow.html#R4"></MAP></DIV>
<DIV STYLE="margin-top:16pt;margin-left:2pt;"><FONT ID="f8" STYLE="background-color:#DCDCDC;">Diagram Contents Summary</FONT></DIV>
<DIV STYLE="margin-left:10pt;margin-top:8pt;"><IMG SRC="doc-images/tv-activity4.png"> <FONT ID="f7">Activity </FONT><FONT ID="f2"><U><A HREF="execute-query-workflow.html#R1">Check workflow status</A></U></FONT></DIV>
<DIV STYLE="margin-left:10pt;margin-top:2pt;"><IMG SRC="doc-images/tv-activity4.png"> <FONT ID="f7">Activity </FONT><FONT ID="f2"><U><A HREF="execute-query-workflow.html#R3">Load workflow from store</A></U></FONT></DIV>
<DIV STYLE="margin-left:10pt;margin-top:2pt;"><IMG SRC="doc-images/tv-activity4.png"> <FONT ID="f7">Activity </FONT><FONT ID="f2"><U><A HREF="execute-query-workflow.html#R4">Navigate to workflow page</A></U></FONT></DIV>
<DIV STYLE="margin-left:10pt;margin-top:2pt;"><IMG SRC="doc-images/tv-activity4.png"> <FONT ID="f7">Activity </FONT><FONT ID="f2"><U><A HREF="execute-query-workflow.html#R2">Submit workflow</A></U></FONT></DIV>
<DIV STYLE="margin-top:13pt;margin-left:2pt;"><TABLE BORDER="0" CELLSPACING="0" CELLPADDING="2" WIDTH="98%"><TR BGCOLOR="#C0C0C0"><TD><FONT ID="f9">Activity Detail</FONT></TD></TR></TABLE></DIV>
<DIV STYLE="margin-left:2pt;margin-top:11pt;"><IMG SRC="doc-images/Activity4.png"> <FONT ID="f11"><A NAME="R1"></A>Activity </FONT><FONT ID="f10">Check workflow status</FONT></DIV>
<DIV STYLE="margin-left:2pt;margin-top:14pt;"><IMG SRC="doc-images/Activity4.png"> <FONT ID="f11"><A NAME="R3"></A>Activity </FONT><FONT ID="f10">Load workflow from store</FONT></DIV>
<DIV STYLE="margin-top:8pt;margin-left:17pt;"><FONT ID="f2"><p> 
User is viewing the page for generating a new workflow. User selects Open from the file menu. Portal displays a dialogue asking for an AstroGrid Store Locator (AGSL). 
</p> 
<p> 
The AGSL requried is the one for the file, in MySpace, holding the pre-defined workflow, but this is not exlained anywhere. There seems to be no facility to browse MySpace to find the file; User is required to know the AGSL. 
</p> 
<p> 
In principle, User types in the AGSL. In pratice, all end users give up at this point. 
</p> 
<p> 
If User manages to type in the correct AGSL, Portal fetches the workflow from MySpace and displays its details by updating the current page. 
</p></FONT></DIV>
<DIV STYLE="margin-top:13pt;margin-left:17pt;"><FONT ID="f12" STYLE="background-color:#DCDCDC;">Transition links</FONT></DIV>
<DIV STYLE="margin-left:23pt;margin-top:8pt;"><FONT ID="f14"><A NAME="R5"></A>to</FONT><FONT ID="f14"> </FONT><FONT ID="f13">Activity</FONT><FONT ID="f14"> </FONT><FONT ID="f14"><U><A HREF="execute-query-workflow.html#R2">Submit workflow</A></U></FONT></DIV>
<DIV STYLE="margin-left:2pt;margin-top:16pt;"><IMG SRC="doc-images/Activity4.png"> <FONT ID="f11"><A NAME="R4"></A>Activity </FONT><FONT ID="f10">Navigate to workflow page</FONT></DIV>
<DIV STYLE="margin-top:8pt;margin-left:17pt;"><FONT ID="f2"><p> 
User is viewing a portl page that has the main menubar. User selects Job manager from the Workflow menu. Portal displays the page for generating a new workflow. 
</p></FONT></DIV>
<DIV STYLE="margin-top:13pt;margin-left:17pt;"><FONT ID="f12" STYLE="background-color:#DCDCDC;">Transition links</FONT></DIV>
<DIV STYLE="margin-left:23pt;margin-top:8pt;"><FONT ID="f14"><A NAME="R6"></A>to</FONT><FONT ID="f14"> </FONT><FONT ID="f13">Activity</FONT><FONT ID="f14"> </FONT><FONT ID="f14"><U><A HREF="execute-query-workflow.html#R3">Load workflow from store</A></U></FONT></DIV>
<DIV STYLE="margin-left:2pt;margin-top:16pt;"><IMG SRC="doc-images/Activity4.png"> <FONT ID="f11"><A NAME="R2"></A>Activity </FONT><FONT ID="f10">Submit workflow</FONT></DIV>
<DIV STYLE="margin-top:8pt;margin-left:17pt;"><FONT ID="f2"><p> 
User is viewing the page for generating a workflow, with the desired workflow loaded into the page. User selects submit from the file menu. Portal submits the workflow to JES. 
</p> 
<p> 
I don't know what happens in Portal after a successful submission as I've never managed to submit a workflow. 
</p> 
<p> 
On a successful submission, JES executes the job-step that is the query immediately. JES retrieves the query details (from MySpace or from the submitted job?). JES locates the archive's web-service endpoint using the resource registry. JES submits the query to the archive. 
</p> 
<p> 
On a successful submission of the query, Archive translates the sADQL of the query into SQL and executes the latter form of the query on its RDBMS. Archive receives the results table into memory, translates it into XML (VOTable format) and writes it out to MySpace. Archive then reports completion to JES. 
</p> 
<p> 
JES records the completion status from Archive in the file representing the workflow. 
</p></FONT></DIV>
<DIV STYLE="margin-top:10pt;margin-left:16pt;"><FONT ID="f12" STYLE="background-color:#DCDCDC;">Hyperlinks to elements:</FONT></DIV>
<DIV STYLE="margin-left:22pt;margin-top:6pt;"><FONT ID="f2">to </FONT><FONT ID="f7">ActivityDiagram</FONT> <FONT ID="f15"><U><A HREF="submit-workflow.html">submit-workflow</A></U></FONT></DIV>
<DIV STYLE="margin-top:14pt;margin-left:17pt;"><FONT ID="f12" STYLE="background-color:#DCDCDC;">Transition links</FONT></DIV>
<DIV STYLE="margin-left:23pt;margin-top:8pt;"><FONT ID="f14"><A NAME="R7"></A>to</FONT><FONT ID="f14"> </FONT><FONT ID="f13">Activity</FONT><FONT ID="f14"> </FONT><FONT ID="f14"><U><A HREF="execute-query-workflow.html#R1">Check workflow status</A></U></FONT></DIV>
</BODY>
</HTML>
