<html>
<body>
The delegates make calling Astrogrid services as trivial as creating a Delegate instance,
and then calling a method on it.

<h3>Quick Start to Using Datacenter Delegates</h3>

You will need one delegate instance per service you are connecting to.  You can then use that
one delegate to make as many calls to that service as you like.
<p>
<h4>Creating a delegate</h4>
Don't use a delegate constructor to create a delegate, use the call:
<p>
<code><pre>
  FullSearcher delegate = DatacenterDelegateFactory.makeFullSearcher(String endpoint);
</pre></code>
or
<code><pre>
  ConeSearcher delegate = DatacenterDelegateFactory.makeConeSearcher(String endpoint);
</pre></code>
<p>
Note that some datacenters might provide more than one connection type, but this is (presumably?)
information you can find in the registry.  You will get an exception if you try to create a delegate
type that cannot be served on that endpoint.
<p>
<h3>Using an {@link org.astrogrid.datacenter.delegate.FullSearcher}</h3>
<h4>Doing a Query</h4>
Call {@link org.astrogrid.datacenter.delegate.FullSearcher#doQuery}to carry out a blocking query
on the service.
<p>
To start an asynchronous query, you first call
{@link org.astrogrid.datacenter.delegate.FullSearcher#makeQuery} which returns
a status code and a {@link org.astrogrid.datacenter.delegate.DatacenterQuery} object,
 which you then use to control and monitor
the query at the server end.  Your listeners will be notified when the query is complete,
and you can then call getResultsAndClose() which returns a url of where to find the
results.  NB once this call is made you may not be able to access information on
that query ID 'session' again.

<h4>Query Languages</h4>
At present, the two languages supported are ADQL and SQL. However, others are possible.
Different datacenter installations may accept different languages / versions of languages.
This info will presumably be available from the registry.
<p>
The <tt>doQuery</tt> and <tt>makeQuery</tt> methods of <tt>FullSearcher</tt> accept a query-body
with type {@link org.w3c.dom.Element}. So whatever query language / representation is being used,
the query must be converted to this type before being passed to the <tt>FullSearcher</tt>.
The helper classes {@link org.astrogrid.datacenter.adql.ADQLUtils} and {@link org.astrogrid.datacenter.sql.SQLUtils}
provide methods to do this conversion for ADQL and SQL queries.

<h4>Doing other things</h4>
Refer to the DatacenterDelegate methods.

<h3>What you will need</h3>
<p>
You will need the following datacenter packages:
<blockquote>
<pre><code>org.astrogrid.datacenter.delegate
org.astrogrid.datacenter.common
org.astrogrid.datacenter.io</code></pre>
</blockquote>
and the following 3rd party ones:
<p>
<li>RMI/RPC implementation, eg <code>jaxrpc.jar</code>
<li>Axis library (for XMLUtils), ie <code>axis.jar</code>
<li>XML implementation, eg ...
<li>SAX implementation, eg...
<li>...more...
<p>
<i>In fact, this information is better expressed in the maven descriptor - see <tt>project.xml</tt>
<p>
<h3>A matter of state</h3>

In principle a delegate has 'state', in that it represents the clients view on a single server
for as long as it exists.  However, the WebDelegate uses http to communicate with the server, and
http has no concept of state.
<p>
(Having said this, what we're actually doing is using rpc over http, and there is a 'session'
concept available, but not sure if this works for non-java clients.  To be investigated).
<p>
Most service calls anyway are atomic - a request for information with a response containing that
information or an error.  It is up to the delegate to make sure the response ties in with the
request - to make sure that the delegate is threadsafe (so that if one thread calls a request, and
another does so too before the response returns, the appropriate response is directed to the
appropriate request).  This is done by routing all send/receive pairs through one synchronised
private method.
<p>
What we <i>do</i> have is a query state - it is possible to start a database query, and then request
the status of that query.
<p>
<h3>How they work</h3>

<h4>Web Delegates</h4>

I don't know, ask Noel or Peter about WSDL-generated stubs etc.

<h4>Socket Delegates</h4>
You don't really want to know do you?  Oh alright I'll put stuff in here sometime.

<h4>Grid Delegates</h4>
Nobody knows, not been implemented yet.

<h4>Direct Delegates</h4>
For colocated services; not been implemented yet.

<h4>NVO Cone service Delegates</h4>
For NVO http-post cone search servers.

</body>
</html>
