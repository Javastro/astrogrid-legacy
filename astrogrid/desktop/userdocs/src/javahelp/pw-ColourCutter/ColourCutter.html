<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<link rel="stylesheet" href="../astrodoc.css"/>

<title>Colour Cutter Help</title>

</head>
<body>


<!-- Leave this div here -->
<div id="banner">&nbsp;</div>

<!-- Put your content inside this div -->
<div id="content">


<h1>Colour Cutter Help</h1>
<ul>
<li> <a href="#Summary">Summary</a>
 <ul>
 <li>  <a href="#Datasets">Available Datasets</a> </li>
 </ul>
</li>
<li> <a href="#How_to_run_the_Colour_Cutter">How to run the Colour Cutter</a>
 <ul>
 <li><a href="#Workbench">Using the Workbench</a></li>
 <li> <a href="#Input_parameters">Input parameters</a></li>
 <li> <a href="#Launching_the_workflow">Launching the workflow</a></li>
 <li> <a href="#Results">Getting the results</a></li>
 </ul>
</li>
<li> <a href="#Workflow">Modifying the workflow</a></li>
<li> <a href="#Usage_Notes">Usage Notes:</a>
 <ul>
 <li> <a href="#Troubleshooting">Troubleshooting</a></li>
 <li> <a href="#How_it_works">How it works</a></li>
 </ul>
</li>
<li> <a href="#Development">Development</a></li>
<li> <a href="#Colour_Cutter_Comments">Colour Cutter Comments</a></li>
</ul>

<h2><a name="Summary"> Summary </a></h2>

<p>
This Astrogrid science service allows the user to select IR and
optical objects by region and by colour. It is available via the
Workbench.
</p>

<h3><a name="Datasets">  Available Datasets </a></h3>

<p/>
<table>
<tr> <th><strong>Catalogue</strong></th><th>  <strong>Sky coverage</strong> </th><th> <strong>Bands</strong> (enter exact column names) </th><th> <strong>Wavelengths</strong> (approx, micron) </th><th> <strong>Row limit</strong> /source density </th></tr>

<tr><td> <a href="http://pegasus.phast.umass.edu/" target="_top">2MASS</a> </td><td> all sky </td><td> j_m h_m k_m </td><td> 1.24, 1.66, 2.16 </td><td> 10000 per 1 - 20 sq deg </td></tr>
<tr><td> <a href="http://www.journals.uchicago.edu/AJ/journal/issues/v125n2/202452/202452.html" target="_top">USNO-B</a> </td><td> all sky </td><td> B1Mag R1Mag NMag </td><td> 0.4, 0.7, 10, </td><td> 10000 per 0.2 - 1 sq deg </td></tr>

<tr><td> <a href="http://www.ast.cam.ac.uk/~wfcsur/science/overview/" target="_top">INT-WFS</a> </td><td> <a href="http://www.ast.cam.ac.uk/~wfcsur/science/fields/" target="_top">region/band details</a> </td><td> U B g V r i z Harris_R RGO_I </td><td> 0.36, 0.44, 0.48, 0.55, 0.63, 0.64, 0.77, 0.81, 0.91 </td><td> 2000 per 0.05 - 0.1 sq deg </td></tr>
</table>
<p />


<h2><a name="How_to_run_the_Colour_Cutter"> How to run the Colour Cutter </a>  </h2>
<p/>

<h3><a name="Workbench">Using the Workbench </a></h3>
<p/>
<ul>
<li> Launch the <a href="http://software.astrogrid.org/userdocs/workbench.html">AstroGrid Workbench</a> (see <a href="../WorkBench/WorkBench.html">Workbench Help</a>)</li>
<li> From the Workbench, select Parameterised Workflows &gt; Run 
</li>
<li> Select the Colour Cutter in the Template Chooser</li>

</ul>

<p/>
<a href="CCutTaskEditor.png"> <img src="CCutTaskEditor.png" alt="CCutTaskEditor.png" /> </a><p/>

<h3><a name="Input_parameters"> </a> Input parameters </h3>
<p/>
<ol>
<li> Your first catalogue is 2MASS, your second must be chosen from USNO-B or INT-WFS - see <a href="#Datasets">Available Datasets</a> </li>
<li> Select a celestial region  by central coordinate (J2000) plus size of box side; all units are decimal degrees and no curvature correction is made (so near the poles, the actual sky coverage will be compressed in the direction of Right Ascension).
 <ul>
 <li> This is entered in decimal degrees e.g. <strong>56.75,+23.867,1.0</strong> (RA,Dec,Radius - no spaces) - check the coverage if the catalogue is not all-sky</li>
 <li> There are row limits for each datacentre which restrict the number of objects which can be returned by a single query.  If you have stringent colour restrictions you may cover more sky but, if all objects in a region are returned, the limits are given  (the source density is highest in mid-northern latitudes for the all-sky catalogues).</li>
</ul>
</li>
<li> Select the colour cut conditions for a pair of catalogues such that 
 <ul>
 <li> Band1_mag - Band2_mag &gt; mag_limit </li>
 <li> This is entered as e.g. <strong>j_m,k_m,2.0</strong> (exact band names as in the catalogue).</li>
 <li> You must select the first pair of bands from 2MASS and the second from one of the two optical catalogues.</li>
 <li> Selection cannot be made by comparing values in different catalogues but you can do this yourself using TopCat.</li>
 </ul>
</li>
<li> If the catalogue gives uncertainties, values of Band2 are chosen to have errors in the range [0,0.5] but Band1 may be a non-detection or very uncertain (so the selection may be based on upper limits).</li>
<li> The IR and optical colour-selected extracts are crossmatched using a 5 arcsec search radius as the 2MASS uncertainties dominate the position errors in most cases.</li>
<li> The main output catalogue (in VOTable format) will contain the position of each object, its catalogue ID, and all available principal magnitude measurements (and uncertainties if given) plus the requested colours and uncertainties (if available). 
 <ul>
 <li> The ColourCutter creates a directory in your <a href="../MySpace">MySpace</a>  named according to the position e.g. <strong>CCut_RA56.7Dec23.867_1.0</strong> to store these results.</li>
 </ul>
</li>
</ol>
<p/>
<h3><a name="Launching_the_workflow"> </a> Launching the workflow</h3>
<p/>
<ol>
<li> Click on OK at the bottom of the Task Editor window (resize it if necesary to see the button)</li>
<li> You will be asked if you want to save a copy of the workflow.
 <ul>
 <li> If you choose to do this in <a href="../MySpace">MySpace</a>, select a folder and a file name.  This will allow you to modify it for future use.
 </li>
 </ul>
</li>
<li>Once the task is running the   <a href="../Lookout">Lookout</a> will appear and you can follow the progress of your query....  
<a href="CCutMessages0.png"> <img src="CCutMessages0.png" alt="CCutMessages0.png" /> </a>
 <ul>
 <li>Click on the 'glasses' icon to get a transcript.</li>
 <li>Highlight 'Information' to review the inputs being processed. 
<a href="CCutMessages1.png"> <img src="CCutMessages1.png" alt="CCutMessages1.png" /> </a></li>
 </ul>
</li>
</ol>
<p/>
<h3><a name="Results"> </a> Getting the results</h3>
<p>
 When the status reaches 'COMPLETED' you can examine the results.
</p>
<ol>
<li> You can launch the  <a href="../MySpace">MySpace</a> browser from the Workbench.
 <ul>
 <li> Note the Refresh button (circled in red). <a href="CCutMySpace0.png"> <img src="CCutMySpace0.png" alt="CCutMySpace0.png" /> </a></li>
 </ul>
</li>
<li> You should see a directory e.g. <strong>CCut_RA56.7Dec23.867_1.0</strong> containing files labelled by the selection criteria - e.g.<br/> <strong>j_m-k_m.gt.1.0.vot</strong> (IR); <strong>i-z.gt.2.0.vot</strong> (optical);<br/> <strong>j_m-k_m.gt.1.0_and_i-z.gt.2.0.vot</strong> (matched, with colours added).
 <ul>
 <li>The output colour columns are called "ir_colour", "ir_col_err", "opt_colour" and "opt_col_err" (if present).</li>
 </ul>
</li>
<li>If you re-run a query at the same position but a different colour selection the files will be written to the same directory and the intermediate files (IR.vot, optical.vot), which contain the colours for each data set separately, will be overwritten.</li>
<li> You can save the results to your desktop or pass them directly to any application with access to MySpace e.g. <a href="http://www.starlink.org/topcat"> TopCat</a>, which  can be used to sort the data, form more colours etc. and plot the  output. <a href="CCTopCat.png"> <img src="CCTopCat.png" alt="CCTopCat.png" /> </a> </li>
</ol>
<p/>
<h3><a name="Workflow"> </a>Modifying the workflow</h3>
<p>
If you saved the workflow itself to MySpace (whilst launching it) you can use it as a template to construct your own workflows.  The native format is XML but AstroGrid provides a handy graphical interface:
</p>
<ol>
<li> Use the Workbench to launch the <a href="../WorkflowBuilder">Workflow Builder</a></li>
<li> In the Workflow Builder, use the File menu to load your workflow from MySpace.
 <ul>
 <li>Double-click on an item to edit it</li>
 <li> See the  <a href="../WorkflowBuilder">Workflow Builder</a> help for more information about how to add extra processes etc.</li>
 </ul>
</li>
</ol>
<a href="CCutWB_WFView.png"> <img src="CCutWB_WFView.png" alt="CCutWB_WFView.png" /> </a>
<p/>

<h2><a name="Usage_Notes"> </a><a name="Usage_Notes_"> </a> Usage Notes: </h2>

<h3><a name="Troubleshooting"> </a> Troubleshooting </h3>
<p>
Some common things to check:
</p>
<ol>
<li> Use the Refresh button if nothing seems to be happening in the Lookout or you can't find your results in MySpace.</li>
<li> Did you ask for a region without data in all the requested wavebands? 
 <ul>
 <li>The output directory name is based on the position, or you can review inputs in the Lookout. You can check coverage in the table above.</li>
 <li> If the INT-WFS catalogue was chosen, or if a very small box was used, are there data in the search box?</li>
 <li>Do your inputs correspond to the  exact band names as used in the catalogue?</li>
 <li> If the separate IR and optical files seem OK but there is no final matched file, perhaps there were no objects in common. You can check ant match individual tables in TopCat </li>
 <li> If you selected a very large region the row limit may have been exceeded (see table above).</li>
 </ul>
</li>
<li>If the Lookout status is 'ERROR', use the 'spectacles' to view the transcript and see where it went wrong.</li>
<li><a href="http://software.astrogrid.org/monitor/status.xml">Site Status</a> may tell you if archives are unavailable.</li>
</ol>
<p/>

<h3><a name="How_it_works"> </a> How it works </h3>
<p />
<ol>
<li> The  range of RA and Dec to be searched and the colour constraints are written into template queries, one for each catalogue. An additional constraint to select only Band2 values with small errors is added. The queries are in ADQL, an XML translation of SQL specialised for astronomy and solar science.</li>
<li> For each catalogue selection returned to <a href="../MySpace">MySpace</a>, a new column is written for the colour (Band1-Band2) and for the error (simply (sqrt[Band1err^2 + Band2err^2]), where available).</li>
<li> The 'coloured' catalogue selections are crossmatched, finding all matches within 5 arcsec.</li>
<li> The matched catalogue is returned to <a href="../MySpace">MySpace</a>.</li>
</ol>
<p/>

<hr/>
<p/>
<h2><a name="Development">Development </a>  </h2>
<p>
Features which we hope to add include:
</p>
<ul>
<li> Making it easier to discover if the region you want contains the bands you want,  for catalogues with partial coverage;</li>
<li> Adding more catalogues </li>
<li> Allowing Band1 and Band2 to be from different catalogues</li>
<li> Increasing the number of catalogue rows which can be processed at once.</li>
</ul>
<p>
Priorities will be informed by user feedback, so please let us know what you would like to see.  For example, there could be additional inputs to determine the match radius or the error handling could be changed to exclude all catalogue measurements which were lower limits.
</p>
<p>
See <a href="http://wiki.astrogrid.org/bin/view/Astrogrid/UcPersistentTableJoin" target="_top">UcPersistentTableJoin</a>  for an elegant solution involving querying and crossmatching separate tables in one query, using a <a class="twikiLink" href="/bin/view/Astrogrid/MySpace">MySpace</a> database to handle the intermediate data (VOStore)
</p>
<p>
Other issues:
</p>
<ul>
<li> Including on-the-fly source extraction/upper limit measurement from images
</li>
<li> Including user's own data from <a class="twikiLink" href="/bin/view/Astrogrid/MySpace">MySpace</a> or URL
</li>
<li> Providing colour corrections so that the user can enter criteria in a standard photometric system
</li>
<li> Aperture corrections</li>
<li> Selecting the optimum search radii for multi-catalogue cross-matches</li>
<li> Astrometric alignment</li>
</ul>

<hr/>  

<p/>

For further suggestions and discussion of development please see
the AstroGrid wiki page <a href="http://wiki.astrogrid.org/bin/view/Astrogrid/ColourCutterComments">ColourCutterComments</a>

<!-- Put author information here -->
<hr/>
<p>
<em>Author: Anita Richards, amsr@jb.man.ac.uk</em><br/>
<em>Last revised : 17 Mar 2006</em>
</p>

</div>
</body>
</html>
