<?xml version="1.0"?>
<!DOCTYPE module  [
	<!ENTITY descriptors SYSTEM "classpath:/org/astrogrid/desktop/hivemind/ivoa-descriptors.xml">
	]>
<module id="ivoa" version="1.0.0" package="org.astrogrid.acr.ivoa">
	IVOA standard services.
	<!-- new configurations -->
	
	
	<!-- contributions to existing configurations -->

	
	<contribution configuration-id="framework.descriptors">
		<acr-module name="ivoa" description="IVOA Standard Services">
		&descriptors;
		</acr-module>
	</contribution>	
		
	<contribution configuration-id="framework.acrServices">
			<acrService id="ssap" interface="Ssap" />
			<acrService id="siap" interface="Siap" />
			<acrService id="skyNode" interface="SkyNode"/>
			<acrService id="adql074" interface="Adql074" />
	</contribution>
	
	<contribution configuration-id="system.uiStructure" if="not (property system.browser.disabled)">
		<action parentName="projects" name="ivoaProject" text="IVOA" iconName="ivoa.gif"
			object="service:system.browser" methodName="openURL"
			>
			<tooltip>Home Page for the International Virtual Observatory Alliance</tooltip>
			<parameter>http://www.ivoa.net</parameter>
		</action>		

	</contribution>	
	
		<!-- factory defaults for enabled services and config properties -->
	<contribution configuration-id="hivemind.FactoryDefaults">
		<default symbol="ivoa.adql074.endpoint" value="http://openskyquery.net/AdqlTranslator/ADQLTrans.asmx"/>			
	</contribution>

	
	<!-- everything else - eager when testing -->
	<contribution configuration-id="hivemind.EagerLoad" if="property acr.debug">
		<load service-id="ssap"/>
		<load service-id="siap" />
		<load service-id="skyNode" />
		<load service-id="adql074" />
	</contribution>	
	
	<!-- services and implementations -->
	
	<service-point id="ssap" interface="Ssap">
		Simple Spectral Access Protocol
		<interceptor service-id="system.throbber" />		
		<invoke-factory>
			<construct class="org.astrogrid.desktop.modules.ivoa.SsapImpl" />
		</invoke-factory>	
	</service-point>

	<implementation service-id="ssap" if="property ivoa.ssap.disabled">
		<invoke-factory service-id="hivemind.lib.PlaceholderFactory" />	
	</implementation>
			
		<service-point id="skyNode" interface="SkyNode">
			Skynode (unfinished)
		<interceptor service-id="system.throbber" />			
		<invoke-factory>
			<construct class="org.astrogrid.desktop.modules.ivoa.SkyNodeImpl"/>
		</invoke-factory>			
	</service-point>
	
	<implementation service-id="skyNode" if="property ivoa.skynode.disabled">
		<invoke-factory service-id="hivemind.lib.PlaceholderFactory" />	
	</implementation>

	<service-point id="siap" interface="Siap">
		Simple Image Access Protocol
		<interceptor service-id="system.throbber" />		
		<invoke-factory>
			<construct class="org.astrogrid.desktop.modules.ivoa.SiapImpl"/>
		</invoke-factory>			
	</service-point>
	
	<implementation service-id="siap" if="property ivoa.siap.disabled">
		<invoke-factory service-id="hivemind.lib.PlaceholderFactory" />	
	</implementation>	

	<service-point id="adql074" interface="Adql074">
		ADQL convertor
		<interceptor service-id="system.throbber" />		
		<invoke-factory>
			<construct class="org.astrogrid.desktop.modules.ivoa.Adql074DynamicImpl">
				<set property="endpoint" value="${ivoa.adql074.endpoint}" />
			</construct>
		</invoke-factory>			
	</service-point>
	
	<implementation service-id="adql074" if="property ivoa.adql074.disabled">
		<invoke-factory service-id="hivemind.lib.PlaceholderFactory" />	
	</implementation>		
	
	
 </module>
 