<?xml version="1.0"?>
<!DOCTYPE module  [
	<!ENTITY descriptors SYSTEM "classpath:/org/astrogrid/desktop/hivemind/votech-descriptors.xml">
	]>
<module id="votech" version="1.0.0" package="org.votech">
<!--  PREAMBLE -->
	<contribution configuration-id="framework.descriptors">
		<acr-module name="votech" description="Services and infrastructure developed as part of the VOTech project">
		&descriptors;
		</acr-module>
	</contribution>	
		
	<contribution configuration-id="framework.acrServices">
			<acrService id="vomon" interface="VoMon" />
	</contribution>
	



	
	<!-- services and implementations -->
<!-- 
=============================================
VOMON
 -->	
	<service-point id="vomon" interface="org.astrogrid.desktop.modules.votech.VoMonInternal">
		Service Monitor		
		<invoke-factory model="primitive">
			<construct class="org.astrogrid.desktop.modules.votech.VoMonImpl" >
			<string>${votech.vomon.endpoint}</string><!--  endpoint to fetch vomon status.xml from -->
			<int>${votech.vomon.reload}</int><!--  period between refreshes of the status.xml (seconds) -->
			<service>ivoa.cache</service>
			<service>system.ui</service>
			</construct>
		</invoke-factory>	
	</service-point>

	<implementation service-id="vomon" if="property votech.vomon.disabled">
		<invoke-factory service-id="hivemind.lib.PlaceholderFactory" />	
	</implementation>	
	
	<contribution configuration-id="framework.preferences">
		<preference name="votech.vomon.endpoint" 
			requires-restart="true"
			default-value="http://thor.roe.ac.uk/vomon-full/status.xml" >
			<ui-name>Endpoint of the monitoring service</ui-name>
			<description>A http url that returns a vomon xml document</description>
			<alternative>http://software.astrogrid.org/all-vo-mon/status.xml</alternative>
		</preference>
		<preference name="votech.vomon.reload" 
			requires-restart="true"
			default-value="3600" > <!--  hourly -->
				<ui-name>System monitoring refresh period</ui-name>
				<units>seconds</units>
				<description>Period between reloading the monitoring information</description>
			</preference>
	</contribution>

	<!--  load on startup -->
	<contribution configuration-id="hivemind.EagerLoad">
		<load service-id="vomon"/><!--  fetches status fiule from service on startup. -->
	</contribution>	
	
	<contribution configuration-id="system.scheduledTasks">
		<object>service:vomon</object><!--  reloads the data periodically -->
	</contribution>
	
<!-- 
=========================================\
TAGGING
 -->
	<!--  
		<service-point id="tagging" interface="Tagging">
		Service Monitor		
		<invoke-factory>
			<construct class="org.astrogrid.desktop.modules.votech.TryntTaggingImpl" >
			</construct>
		</invoke-factory>	
	</service-point>

	<implementation service-id="tagging" if="property votech.tagging.disabled">
		<invoke-factory service-id="hivemind.lib.PlaceholderFactory" />	
	</implementation>
		-->
 </module>
 