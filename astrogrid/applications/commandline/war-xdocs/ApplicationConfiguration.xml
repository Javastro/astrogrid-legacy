<?xml version="1.0" ?>
<!-- would be nice to get the doctype right so that we can have assisted editing for the type - need to have a dtd for the xdocs though!!
    <!DOCTYPE document PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
    -->
<!DOCTYPE document SYSTEM "xdoc.dtd" >
<document>
<properties>
	<author email="pah@jb.man.ac.uk">Paul Harrison</author>
	<title>CEA Command Line CEC Configuration</title>
</properties>
<body><section name="CommandLine Application Configuration">
	<p>The Commmand line Execution Controller is a component that can be used to wrap legacy command line applications in a specialized CEA web service so that it can become part of the VO.</p>
	<subsection name="Command Line Application prerequisites">
		<p>For the CEA Command Line Execution Controller to be able to run an application, it must fit into the model of a commnand line application that the CLEC understands. Amongst other characteristics,
			 it must be possible to run the application to completion with arguments supplied on the command line. 
			 </p>
		<p>Characteristics of the application that cannot be supported include</p>
		<ul>
			<li>requiring user input from a GUI</li>
			<li>requiring a GUI to display results</li>
			<li>requiring user input of any kind after execution had been started</li>
		</ul>
		<p>The command line application parameters should be specified by one of the "standard" unix methods</p>
		<ul>
			<li>by position</li>
			<li>by a switch of the form -param value</li>
			<li>by a switch of the form  param=value</li>
		</ul>
		
		<p>It is possible that an application that does not quite meet these requirements in a small fashion could be acommodated by writing an adapter class that extends the standard org.astrogrid.applications.commandline.CommandLineApplication model.  </p>
	</subsection>
	<subsection name="Configuration File">
		
<p>This file should be of the same form as
<a href="http://www.astrogrid.org/viewcvs/*checkout*/astrogrid/applications/config/Attic/applicationDefinitions.xml?rev=HEAD&amp;content-type=text/xml">this example configuration file</a>

which has
<a href="http://www.astrogrid.org/viewcvs/*checkout*/astrogrid/workflow-objects/schema/AGApplicationBase.xsd?rev=HEAD&amp;content-type=text/plain">AGApplicationBase.xsd</a>
as its schema.</p>
<p>
&lt;CommandLineExecutionControllerConfig&gt; that contains &lt;Application&gt; elements (you will have one for each of your scripts) - each of the &lt;Applications&gt; has a set of &lt;Parameters&gt; and one or more &lt;Interfaces&gt;.
For this type of CEC we need to define a series of &lt;CmdLineParameterDefn&gt; elements corresponding to each of the command line parameters that there are.
For command line applications parameters are typically specified in one of 3 ways under unix
and the CEC can cope with any of these (theoretically in any combination, but I have not exhaustively tested this, and I doubt that I have covered everything)
</p>
<p>Each &lt;CmdLineParameterDef&gt; has a set of attributes that specify which of the above categories the parameter falls under, as well as some subelements that further specify the parameter.
</p>
<dl>
	
<dt>name</dt> - this is the name of the parameter - the default behaviour is that this name is the same as the string that is used to denote the parameter on the command line (if there is one) - however you can give the parameter any name you like (as long as it is unique for a particular application as you can specify the name that is used on the command line  using the commandSwitch attribute. Alternatively you can specify the position of the parameter with the commandPosition attribute if there is no switch.

<dt>type</dt> - this specifies what type the parameter is as well as how the CEC should find the parameter - so it might be just string - if the parameter is a string that is passed directly, or MySpace_FileReference if the paramter is actually a reference to a file in MySpace. (Note that the use of this parameter has changed quite a bit in iteration 6 - I am describing the iteration 5 situation). You should look in the schema
			<dt>complex</dt>
			<dt>double</dt>
			<dt>text</dt>
			<dt>boolean</dt>
			<dt>anyURI</dt>
			<dt>anyXML</dt>
			<dt>VOTable</dt>
			<dt>RA</dt>
			<dt>Dec</dt>
			<dt>ADQL</dt>
			<dt>binary</dt>
			<dt>FITS</dt>

http://www.astrogrid.org/viewcvs/*checkout*/astrogrid/workflow-objects/schema/AGParameterDefinition.xsd?rev=HEAD&amp;content-type=text/plain

at the definition of the parameterTypes simple type for the full list of allowable types - but they are mostly the obvious atomic types as well as a few special types for fetching things from MySpace.
<dt>fileRef</dt>
<dt>commandSwitch</dt><dd>This is the text of the command switch (without any hyphen or equals characters). If this is set to the special value "---" then it means that the parameter will not be added to the command line at all - this is useful sometimes in allowing a value to be passed to the java wrapper class.</dd>
<dt>commandPosition</dt>
<dt>switchType</dt>
</dl>

<p>The elements that can occur within the &lt;CmdLineParameterDef/&gt; are</p>
<dl>
<dt>&lt;UI_Name/&gt;</dt> <dd>the name that will be used for display in the portal for the parameter</dd>
<dt>&lt;UI_Description/&gt;</dt> <dd>a description of the parameter that will be used in the portal</dd>
<dt>&lt;UCD/&gt;</dt> <dd>the ucd for the parameter if it has one - at the moment nothing uses this.</dd>
<dt>&lt;DefaultValue/&gt;</dt><dd> can be used to display a default value in the portal</dd>
<dt>&lt;Units/&gt;</dt> <dd>can be used to specify the units in the portal.</dd>
</dl>
<p>
An &lt;Interface&gt; is simply a collection of parameters - you might have a simple interface that consists of only one of the possible parameters and a complex one that consists of all the possible parameters. Each interface consists of a number of &lt;input&gt; and &lt;output&gt; parameters (designated by the pref element that points to the &lt;CmdLineParameterDef&gt; above) - This classification is particularly important in the case of parameters that specify MySpace file references, as this is how CEC knows whether to fetch the values of put them.
</p>
		
	</subsection>
	<subsection name="Writing a custom adapter class">
		<p>A  CommandlineApplication goes through a series of stages</p>
	</subsection>
	</section> 
	<section name="Global CLEC Configuration">
		<p>To see information for configuring the CLEC itself see ....</p>
	</section>
</body>
</document>
