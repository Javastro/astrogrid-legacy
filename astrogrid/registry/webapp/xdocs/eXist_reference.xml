<?xml version="1.0" encoding="ISO-8859-1" ?>
<document>
    <properties>
        <title>eXist Reference</title>
    </properties>
    <body>
   
    <section name="eXist and other uses with Registry">
 <p>
      This docs page has now changed because most of the backups and anything else needed to be done can be 
      accomplished via the clientGUI or Web Dav after installing the registry notice the "DB client and WebDav" in the menu for
      you to read.<br />
      One or two other major section is here about moving the data directory out of your webapp for those Registries who have 
      eXist bundled up into there webapp.
    </p>    
      <p>
		eXist is a native XML database used by the registry to store its metadata in a xml format and to peform XQuery operations to retrieve the metadata.
 You can find all the information about exist <a href='http://exist.sourceforge.net/'>here</a>.  Below you will find sections about 
 information about eXist and how it works with the Registry.
      </p>
      <subsection name="eXist embedded (Moving your Data Out)">
      <p>
		By default eXist is embedded into the registry web application meaning you don't have to download it or setup any settings.  The Registry
 already has all the necessary libraries to run eXist.  The default of the registry though puts all the information (xml data storage) inside the webapp and
 this in general is not good and is recommended to change because of upgrading or undeploying of the registry would lose the data.  
 You could of course make backups of the data directory and after doing an upgrade or deploy simply copy back over the data directory and restart your servlet/j2ee container.  
 But there is a easier way to make settings use a different directory to store your data:
		<ul>
			<li>Create some other direcotry not under tomcat of where you would like your data to be stored for eXist.</li>
            <li>Copy the conf.xml, and the whole "data" directory from your {context name}/WEB-INF directory and the whole "lib" directory. So inside your directory you should now have conf.xml, data {directory}, lib {directory}.</li>
            <li>Optionally if this is a brand new registry and your not able to get at your directory because the servlet container did not unpack the war then you can download an empty or
                full registry at <a href='http://www.astrogrid.org/maven/org.astrogrid/zips'>Zip Directory</a> with the name astrogrid-registry-xmldb_exist-{version relase}.zip or -full.zip may be encountered.
			</li>
			<li>Change the JNDI property of  "reg.custom.exist.configuration"  and point to this directory plus conf.xml ex: /exist/db/conf.xml.</li>
			<li>That is all you, now when data is being stored it is using this new data directory, be sure during upgrades to set that property to your directory.  Also note "Windows" OS users "may" need to escape there slashes ex: c:\\existstore.</li>
		</ul>		
      </p>
      </subsection>      
	  <subsection name="Making backups and upgrades">
		<p>
			I thought this deserved a special section to make attention to this small fact.  eXist stores all its information in a directory
called "data".  In embed mode you will find it in the {context name}/WEB-INF/data (if you did not move the data directory out (see above)).  In external it is the same EXIST_HOME/webapp/WEB-INF/data.  It can sometimes
be advisable to make a backup of this directory ever now and then.  No matter how badly something happens to eXist restoring this directory will put
everything correct again.<br />
            To make backups of the xml files which is also good you can do this in a number of ways.
            1.) eXist provides a client GUI to allow you to do many things internally to your db including backups and restores.  You should be able to
            click on the 'Launch' button located at <a href='http://exist.sourceforge.net/'>eXist</a>
            2.) commandline.  You will find a backupandrestore.{sh/bat} scripts bundled for embedded eXist located in WEB-INF. Or found
            here: <a href='http://exist.sourceforge.net/backup.html'>Info</a>  For embedded users the -ouri parameter will be xmldb:exist://{server}:{port}/{registry context}/xmlrpc
		</p>
	  </subsection>
    </section>
  </body>
</document>