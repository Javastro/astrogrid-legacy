<?xml version="1.0" encoding="ISO-8859-1" ?>
<document>
    <properties>
        <title>AstroGrid registry configure</title>
    </properties>
    <body>
	<section name="Properties for Servlet/J2ee containers">
    <p>
    <i>Context Name - is your webapp name (hence usually the unpacked directory name in the webapps).  This will be used
a lot in various documentation usually with curly brackets around it.</i>
    <br /><i>As Noted now on the main docs page, if you plan on being a Full Registry or Larger Publishing Registry (holding thousans of Resources) or simply want your db on a seperate machine.  Then
      recommend installing the db externally please read <a href="external_eXist.html">Using external eXist</a>.</i><br />
    </p>	
	<p>
	    BackGround: For webapps properties are stored in the WEB-INF/web.xml but this xml contains a lot more than just 
	    properties and can be a bit cumbersome to edit by hand.  These properties are known as JNDI environment entries.  
	    Typically servlet containers will have a special GUI for changing these properties and this is what is advised for you to use.
	    Tomcat GUI by default is no longer installed with tomcat 5.5 and the GUI is not known to be good anyways.<br />
	    Tomcat will also allow 'you' to place a special xml properties file in the {tomcat}/conf/Catalina/localhost named {context}.xml.
	    <br />Click on the below link to take you to the property editor page which will write the properties in the conf/Catalina/localhost.
	    Click on this link (advise open in a new window) <a href="../admin/environment-main.jsp">here</a> to edit JNDI properties.	    
	</p>
	</section>
    <section name="Configuration">
      <p>
         This page will take you step-by-step on how to setup the registry to be complete.  Again this page
 will reference Tomcat.<br />
      </p>
      <subsection name="Changing Properties">
      <p>
         First we need to change some properties in the environment entries. Click on the above link to change properties.<br />
         <ul>
            <li></li>

            <li>reg.amend.authorityid - Your main authority id for this registry, normally an institution domain name ex: mssl.ucl.ac.uk</li>
            <li>reg.amend.harvest - *Only if you want registry to automatically harvest then set to "true"</li>
            <li>reg.amend.identify.adminEmail - to your contact e-mail.</li>
            <li>reg.amend.oaipublish.0.1 - *Only if your {context name} is not "astrogrid-registry" then change it or on a different port.</li>
            <li>reg.amend.oaipublish.1.0 - *Only if your {context name} is not "astrogrid-registry" then change it or on a different port.</li>
            <li>reg.custom.restrict.ipaddresses.updates - Restrict to certain ip address for Update web service current setting is localhost(127.0.0.1). Must do this for external clients to update via the Update web service call.</li>
            <li>reg.custom.restrict.ipaddresses - Restrict to certain ip addresses to webdav and xmlrpc servlets current setting is localhost(127.0.0.1). Must do for WebStart Gui or connecting an app via WebDav.</li> 
            <li>You can verify properties are changed with <a href="../admin/fingerprint.jsp">Fingerprint</a>.  Tomcat 5.5 seems to not catch changes automatically and requires a restart of tomcat.</li>
            <li>That is all for properties, you may wish to read the "Registry Reference" to understand other properties.  This also explains further advanced abilities of the registry</li> -->
         </ul>
         <strong>By default the registry runs a xml database inside the webapp where all the data is stored inside the webapp directory.
              It is STRONGLY RECOMMENDED to read the "eXist for Registry" to explain on how to move the data outside your webapp to ensure
no data is lost when upgrading later (this is a fairly simple task and can save you a lot of effort later).  There is also details of backups, client connection to the db.</strong>         
      </p>
      </subsection>
      <subsection name="Setting up for data">
         <p>
            <strong>DO NOT NEED TO DO WHEN UPGRADING</strong>
            <br />
            <strong>Advise to click on the <a href="../admin/fingerprint.jsp">Fingerprint</a> page to confirm properties are changed.   (might want to open in a new tab/window so you can still read docs).</strong>
          <ul>
            <li> 1.) Go to the registry jsp page of "http://../[context name]/admin/index.jsp" (click <a href="../admin/index.jsp">here</a> advise open up in new tab/window) 
             and do the first link for adding Indexes.
              <br />*If your asked for a username and password then it is currently the same as your tomcat manager.             
            </li>
            <li>2.) Now do the second link for "Self Registration" to register
              this registry. This will in setup your first entry into your registry which is your Registry Type describing about this registry.
            </li>
            <li>
              If you are setting up a local publishing Registry and DO NOT WANT TO BE HARVESTED BY OTHER REGISTRIES then stop here, all your
                 entries are complete and other client apps may submit Resources to this registry as long as it is a AuthorityID
                 managed by this Registry. <i>Notice that Registry Type you entered in step one had {managedAuthority} element tags this is what is read to 
determine what authority ids you are allowed to use.</i>
            </li>
            <li><font color='blue'>This part is New. Registry of Registries is a new type of Registry for 1.0 spec and 1.0 VOResources.  It is a Registry
            thats sole purposes is about handling other Registry types so other Registries can discover Registries.  It is hosted by
            IVOA, read the admin/index.jsp about e-mailing the registry group the link to your Registry.</font></li>            
            <li>Now it is time to register your new Registry to the rest of the world.</li>
            <li>3.)Do the second main link on "/admin/index.jsp" "Register with other Registries" for registering your installed registry to a known full registry.  </li>
            <li>Now if your not planning on being a Full Registry then stop here.</li>
            <li>4.)Finally do the third main link on "/admin/index.jsp" to become a full registry by grabbing all the
                     registry types of a full registry.
            </li>
            <li>5.) Now the next time your harvest cycle happens it will begin harvesting these Registries, the first time
               it will harvest with no Date, and then after that it will harvest by date.  Optionally there is a "/admin/harvestResource.jsp" to perform
                  harvests on individual Registries.
            </li>
            <li>You're done.</li>
          </ul>
         </p>
      </subsection>
    </section>
   </body>
</document>