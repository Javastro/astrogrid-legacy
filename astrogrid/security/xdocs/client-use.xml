<?xml version="1.0"?>

<document>

  <title>Use of security facade from a client programme</title>
  
  <body>
  
    <section name="Client APIs">
    
      <p>
      A client should use the ClientSecurityGuard class to do authentication:
      this is the client-side facade.
      The client may also need to use the classes representing credentials:
      Password, AccountName and NonceToken.
      The client should not call directly the other classes of the security
      package; they are only for internal use.
      </p>
      
      <p>
      The ClientSecurityGuard holds credentials for the application and
      makes them available in SOAP messages.
      A client should create a ClientSecurityGuard and populate it with
      credentials, as described in the following sections. The client may
      use one ClientSecurityGuard for any number of messages, or may
      use a different guard for each message. The former case is the
      most common; the latter case applies if the application wishes to
      use different credentials (possibly a different identity) in each
      message.
      </p>
    
    </section>
    
    <section name="Signing on">
    
      <p>
      To sign on the grid, a client should call signOn() on the 
      ClientSecurityGuard, passing a usename and a Password object.
      The username must be an IVORN referring to a user in a
      Community, as understood by the AstroGrid community service.
      The password argument should be an unencrypted Password (q.v.); 
      i.e. a Password constructed by the Password(String, false)
      constructor.
      </p>
      <p>
      Calling signOn() contacts the community service for the named
      user; the security system works out for itself which service
      must be contacted. If the user is known to the community, and
      if the password is correct, a NonceToken is returned and
      retained in the ClientSecurityGuard as a credential.
      The application may retrieve this security token, but in general
      it does not need to do so. The token need not be extracted
      from the guard for it to be used in messaging.
      </p>
      
    </section>
    
    <section name="Mounting guard">
    
      <p>
      To apply the credentials to messages, an application calls
      mountGuard() on the ClientSecurityGuard, passing a JAX-RPC Service
      object as an argument. All messages sent by Call objects subsequently
      generated by that Service will then be annotated with the credentials
      in the ClientSecurityGuard.
      </p>
      <p>
      Stubs generated by WSDL2Java implements the Service interface, so can
      be used with the ClientSecurityGuard. To make this work, the application
      must set the name of the WSDL port on the stub before calling mountGuard()
      on the ClientSecurityGuard. If this is not done, the handlers for the
      credentials are not triggered.
      </p>
      
    </section>
  
  </body>
  
 </document>
