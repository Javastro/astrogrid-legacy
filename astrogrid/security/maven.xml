<?xml version="1.0"?>
<!-- extension maven script -->
<project default="astrogrid-build-site" xmlns:j="jelly:core">

  <!-- Custom AstroGrid goals for nightly build -->
  <goal name="astrogrid-clean" prereqs="clean"/>
  <goal name="astrogrid-deploy-site" prereqs="astrogrid-build-site,site:deploy" />
  <goal name="astrogrid-build-site" prereqs="site"/>
  <goal name="astrogrid-deploy-snapshot" prereqs="jar:deploy-snapshot"/>
  <goal name="astrogrid-build-snapshot" prereqs="jar:snapshot"/>
  <goal name="astrogrid-install-snapshot" prereqs="jar:install-snapshot"/>
  <goal name="astrogrid-deploy-artifact" prereqs="jar:deploy"/>
  <goal name="astrogrid-build-artifact" prereqs="jar:jar"/>
  <goal name="astrogrid-install-artifact" prereqs="jar:install"/>
	
	
	<!-- JDepend fails if this dir is not present.  Hack to fix it. -->	
  <preGoal name="java:compile">
    <mkdir dir="${basedir}/target/classes"/>
  </preGoal>
	
	<!-- Special preconditions for unit tests. The tests use Axis in its
	     'loop-back' mode, with service endpoints expressed using the 'local'
	     URL-scheme. This mode requires that server-config.wsdd be in the
	     CWD when the tests are run. Similarly, the key-store files for
	     the tests need to be in the CWD. -->
	<preGoal name="test:test">
		<copy file="${basedir}/test/wsdd/server-config.wsdd"  todir="${maven.build.dir}" overwrite="true"/>
	</preGoal>
	
</project>
