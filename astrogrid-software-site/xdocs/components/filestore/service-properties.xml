<?xml version="1.0" encoding="ISO-8859-1" ?>
<document>
    <properties>
        <title>AstroGrid FileStore Service Properties</title>
    </properties>
    <body>
        
        <section name="Service properties">
            <p>
		To function correctly, the FileStore service needs to know four things
		<ul>
			<li>The service configuration name</li>
			<li>The IVO identifier for this service in the global registry</li>
			<li>The base URL for HTTP access to files in the store</li>
			<li>The location of the local repository</li>
		</ul>
            </p>
            <subsection name="Service name">
                <p>
		If you are only deploying one FileStore service, just set the service name to
		<code>org.astrogrid.filestore</code> and skip the rest of this section.
                </p>
                <p>
                In order to support multiple FileStore services within one installation,
                each FileStore service can be given a different name.
		<br/>
		Each service uses its name as a prefix to lookup the configuration properties for that service.
		</p>
		<p>
		This feature is used primarily in the AGINAB test environment to enable multiple
		FileStore services to be configured from one shared configuration file.
                </p>
                <p>
		If the service name is set to <code>my.filestore</code>
		<br/>
		Then the service will then look for the rest of its configuration properties using
		this as a prefix.
<source><![CDATA[
my.filestore.service.ivorn=ivo://authority/resource
my.filestore.service.url=http://hostname:port/context/filestore
my.filestore.repository=/var/filestore/...
]]></source>
		This means that one configuration file can support more than one FileStore service.
<source><![CDATA[
#
# Configuration for filestore one
test.one.service.ivorn=ivo://authority/resource
test.one.service.url=http://hostname:port/context/filestore
test.one.repository=/var/filestore/one
#
# Configuration for filestore two
test.two.service.ivorn=ivo://authority/resource
test.two.service.url=http://hostname:port/context/filestore
test.two.repository=/var/filestore/two
]]></source>
                </p>
            </subsection>
            <subsection name="The IVO identifier">
                <p>
		In order to generate the correct identifiers for containes within the store,
		the FileStore service needs to know its IVO registry identifier.
		</p>
		<p>
		This should be set to the same IVO identifier used to register the service in the
		global registry.
<source><![CDATA[
ivo://authority/resource
]]></source>
                </p>
            </subsection>
            <subsection name="The base URL">
                <p>
		In order to generate URLs for external components to access data within the store,
		the FileStore service needs to know the base URL.
                </p>
                <p>
		This should be set to the URL of the Tomcat server, the context for the deployed
		WebApplication, plus the servlet name, <code>filestore</code>.
                </p>
                <p>
		Unless you are modifying the context yourself, the WebApplication context will be the same
		name as the deployed war file.
		If the war file is called <code>astrogrid-filestore.war</code>, then the WebApplication context will be
		<code>astrogrid-filestore</code>.
                </p>
                <p>
		If the URL for your Tomcat server is <code>http://example.org:8080/</code>,
		and the deployed war file was called <code>astrogrid-filestore.war</code>,
		then the base URL will be
<source><![CDATA[
http://example.org:8080/astrogrid-filestore/filestore
]]></source>
                </p>
            </subsection>
            <subsection name="The local repository">
                <p>
		The FileStore service needs read and write access to a local directory on your system to store its data files.
		This directory should not be located within the WebApplication itself, otherwise deploying an updated war file may delete the stored data files.
                </p>
                <p>
		Unix example :
<source><![CDATA[
/var/astrogrid/filestore/
]]></source>
		Windows example :
<source><![CDATA[
C:\\astrogrid\\filestore\\
]]></source>

                    <p style="font-size:x-small;font-style:italic;margin:20px">
                        <img style="float:left;margin-right:5px" src="images/note.gif"/>
                        TODO - Need to check the syntax for a Windows file path.
                    </p>
                </p>
            </subsection>
        </section>
        
    </body>
</document>
