<?xml version="1.0"?>

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Quaestor: generic SPARQL endpoint</title>
<link rel="stylesheet"
      type="text/css"
      href="/base.css"/>
</head>

<body>

<h1>Quaestor: generic SPARQL endpoint</h1>

<h2>HTTP-based interface</h2>

<dl>
<dt><code>GET http://hostport/quaestor/kb/<em>kb-name</em>[/<em>sm-name</em>]</code></dt>
<dd><p>Retrieve either the complete <code><em>kb-name</em></code> model, or
the named <code><em>sm-name</em></code>.  The format is obtained from the
<code>Accept</code> header, which must contain one of the following
MIME types:</p>
<ul>
  <li><code>application/n3</code> and <code>text/rdf+n3</code> for n3.</li>
  <li><code>application/rdf+xml</code> for RDF/XML</li>
  <li><code>text/plain</code> for N-Triples</li>
</ul>
<p>You can add an optional query <code>?model</code> or
<code>?metadata</code> to retrieve the appropriate thing; the default
is to retrieve the model.</p></dd>

<dt><code>GET http://hostport/quaestor/kb/<em>kb-name</em>?sparql=<em>query</em></code></dt>
<dd>Perform the SPARQL query which is URL-encoded in the string
<em>query</em>.</dd>

<dt><code>POST http://hostport/quaestor/kb/<em>kb-name</em></code></dt>
<dd>Takes a SPARQL query as the request body.  By default, this
produces a response in XML, using the SPARQL
<a href="http://www.w3.org/TR/rdf-sparql-XMLres/" >response XML schema</a>,
but the request may be accompanied by an
<code>Accept</code> header containing <code>application/xml</code> or
<code>text/plain</code> to select the corresponding format.</dd>

<dt><code>PUT http://hostport/quaestor/kb/<em>kb-name</em></code></dt>
<dd>Create a new knowledgebase named `<em>kb-name</em>'.  The request content
contains the metadata for the knowledgebase, which is at present just
a string, but will eventually be RDF.  It is an error if the
knowledgebase already exists.  Returns status 204 (No Content) on success,
and a 4xx error message if the knowledgebase already exists or if
there is some other error.</dd>

<dt><code>PUT http://hostport/quaestor/kb/<em>kb-name</em>/<em>sm-name</em></code></dt>
<dd><p>Upload the request body as the content of the submodel named
<em>sm-name</em>.  The
request may have a <code>Content-Type</code> header indicating the
format of the body, which, if it is present, <em>must</em> be one of
<code>RDF/XML</code>, <code>RDF/XML-ABBREV</code>,
<code>N-TRIPLE</code> or <code>N3</code>, with the first one being the
default.</p>
<p>The request may have a <em>query</em> attached, which may be
<code>abox</code>, <code>instances</code> (which is equivalent to
<code>abox</code>) or <code>tbox</code>.  This indicates the type of
the corresponding model.  The default, if no such query is given, is
<code>tbox</code> (I'm not sure how legit this use of query is -- this
might change).</p></dd>

<dt><code>PUT http://hostport/quaestor/code</code></dt>
<dd>Eval the request body as Scheme code.  This is only possible if
the server has been configured to permit it.</dd>

<dt><code>DELETE http://hostport/quaestor/kb/<em>kb-name</em></code></dt>
<dd>Remove the named knowledgebase.  Returns status 204 (No Content)
if it successfully removed the knowledgebase, or a 4xx response if
there was no such knowledgebase to remove.</dd>

</dl>

<h2>XML-RPC interface</h2>

<dl>
<dt><code>get-model(<em>knowledgebase:string</em> 
[,<em>submodel:string</em>])</code> : <em>URI</em></dt>
<dd>Retrieve a URL from which the client can obtain the full
knowledgebase, or just a submodel.  This is just a convenience method,
since the URL returned is just the one described in the HTTP-interface
above.</dd>
</dl>

<h3>Fault codes</h3>
<dl>
<dt>0</dt>
<dd>Seriously malformed request, such as mangled XML, or invalid
request headers</dd>

<dt>1</dt>
<dd>Unrecognised method</dd>

<dt>2</dt>
<dd>Malformed request: the method was syntactically valid and
intelligible, but had the wrong number or type of arguments</dd>

<dt>10</dt>
<dd>Unknown object requested, either an invalid knowledgebase or submodel</dd>
</dl>

</body>
</html>
